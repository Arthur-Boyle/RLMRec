2025-04-02 13:01:24,857 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': True, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'lightgcn_plus', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2, 'amazon': {'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2}, 'yelp': {'layer_num': 3, 'reg_weight': 1e-07, 'kd_weight': 0.01, 'kd_temperature': 0.2}, 'steam': {'layer_num': 3, 'reg_weight': 1e-08, 'kd_weight': 0.001, 'kd_temperature': 0.1}}}
2025-04-02 13:01:33,209 - Epoch   0 Validation set [recall@5: 0.0310 recall@10: 0.0510 recall@20: 0.0816 ] [ndcg@5: 0.0302 ndcg@10: 0.0374 ndcg@20: 0.0474 ] 
2025-04-02 13:01:57,629 - Epoch   3 Validation set [recall@5: 0.0297 recall@10: 0.0496 recall@20: 0.0772 ] [ndcg@5: 0.0290 ndcg@10: 0.0362 ndcg@20: 0.0455 ] 
2025-04-02 13:02:18,283 - Epoch   6 Validation set [recall@5: 0.0297 recall@10: 0.0502 recall@20: 0.0793 ] [ndcg@5: 0.0304 ndcg@10: 0.0375 ndcg@20: 0.0471 ] 
2025-04-02 13:02:34,131 - Epoch   9 Validation set [recall@5: 0.0354 recall@10: 0.0577 recall@20: 0.0902 ] [ndcg@5: 0.0360 ndcg@10: 0.0436 ndcg@20: 0.0542 ] 
2025-04-02 13:02:50,012 - Epoch  12 Validation set [recall@5: 0.0390 recall@10: 0.0650 recall@20: 0.0988 ] [ndcg@5: 0.0397 ndcg@10: 0.0485 ndcg@20: 0.0595 ] 
2025-04-02 13:03:06,410 - Epoch  15 Validation set [recall@5: 0.0428 recall@10: 0.0687 recall@20: 0.1044 ] [ndcg@5: 0.0425 ndcg@10: 0.0514 ndcg@20: 0.0630 ] 
2025-04-02 13:03:27,259 - Epoch  18 Validation set [recall@5: 0.0452 recall@10: 0.0718 recall@20: 0.1095 ] [ndcg@5: 0.0450 ndcg@10: 0.0540 ndcg@20: 0.0662 ] 
2025-04-02 13:03:48,785 - Epoch  21 Validation set [recall@5: 0.0470 recall@10: 0.0726 recall@20: 0.1131 ] [ndcg@5: 0.0464 ndcg@10: 0.0551 ndcg@20: 0.0682 ] 
2025-04-02 13:04:08,690 - Epoch  24 Validation set [recall@5: 0.0486 recall@10: 0.0754 recall@20: 0.1173 ] [ndcg@5: 0.0480 ndcg@10: 0.0571 ndcg@20: 0.0705 ] 
2025-04-02 13:04:27,518 - Epoch  27 Validation set [recall@5: 0.0496 recall@10: 0.0775 recall@20: 0.1199 ] [ndcg@5: 0.0491 ndcg@10: 0.0585 ndcg@20: 0.0723 ] 
2025-04-02 13:04:47,066 - Epoch  30 Validation set [recall@5: 0.0503 recall@10: 0.0796 recall@20: 0.1222 ] [ndcg@5: 0.0497 ndcg@10: 0.0598 ndcg@20: 0.0736 ] 
2025-04-02 13:05:07,544 - Epoch  33 Validation set [recall@5: 0.0519 recall@10: 0.0813 recall@20: 0.1239 ] [ndcg@5: 0.0510 ndcg@10: 0.0610 ndcg@20: 0.0749 ] 
2025-04-02 13:05:22,539 - Epoch  36 Validation set [recall@5: 0.0527 recall@10: 0.0826 recall@20: 0.1271 ] [ndcg@5: 0.0517 ndcg@10: 0.0618 ndcg@20: 0.0765 ] 
2025-04-02 13:05:38,062 - Epoch  39 Validation set [recall@5: 0.0539 recall@10: 0.0830 recall@20: 0.1295 ] [ndcg@5: 0.0530 ndcg@10: 0.0629 ndcg@20: 0.0781 ] 
2025-04-02 13:05:54,229 - Epoch  42 Validation set [recall@5: 0.0541 recall@10: 0.0841 recall@20: 0.1316 ] [ndcg@5: 0.0535 ndcg@10: 0.0637 ndcg@20: 0.0793 ] 
2025-04-02 13:06:10,378 - Epoch  45 Validation set [recall@5: 0.0552 recall@10: 0.0859 recall@20: 0.1329 ] [ndcg@5: 0.0544 ndcg@10: 0.0648 ndcg@20: 0.0803 ] 
2025-04-02 13:06:26,935 - Epoch  48 Validation set [recall@5: 0.0552 recall@10: 0.0873 recall@20: 0.1351 ] [ndcg@5: 0.0547 ndcg@10: 0.0655 ndcg@20: 0.0812 ] 
2025-04-02 13:06:43,307 - Epoch  51 Validation set [recall@5: 0.0558 recall@10: 0.0885 recall@20: 0.1355 ] [ndcg@5: 0.0552 ndcg@10: 0.0663 ndcg@20: 0.0817 ] 
2025-04-02 13:06:59,935 - Epoch  54 Validation set [recall@5: 0.0565 recall@10: 0.0889 recall@20: 0.1375 ] [ndcg@5: 0.0556 ndcg@10: 0.0667 ndcg@20: 0.0826 ] 
2025-04-02 13:07:16,282 - Epoch  57 Validation set [recall@5: 0.0572 recall@10: 0.0900 recall@20: 0.1379 ] [ndcg@5: 0.0560 ndcg@10: 0.0673 ndcg@20: 0.0830 ] 
2025-04-02 13:07:32,314 - Epoch  60 Validation set [recall@5: 0.0576 recall@10: 0.0908 recall@20: 0.1393 ] [ndcg@5: 0.0567 ndcg@10: 0.0681 ndcg@20: 0.0839 ] 
2025-04-02 13:07:48,227 - Epoch  63 Validation set [recall@5: 0.0581 recall@10: 0.0912 recall@20: 0.1391 ] [ndcg@5: 0.0570 ndcg@10: 0.0683 ndcg@20: 0.0841 ] 
2025-04-02 13:08:04,246 - Epoch  66 Validation set [recall@5: 0.0583 recall@10: 0.0919 recall@20: 0.1405 ] [ndcg@5: 0.0573 ndcg@10: 0.0688 ndcg@20: 0.0847 ] 
2025-04-02 13:08:20,055 - Epoch  69 Validation set [recall@5: 0.0587 recall@10: 0.0917 recall@20: 0.1411 ] [ndcg@5: 0.0574 ndcg@10: 0.0688 ndcg@20: 0.0850 ] 
2025-04-02 13:08:36,118 - Epoch  72 Validation set [recall@5: 0.0587 recall@10: 0.0921 recall@20: 0.1421 ] [ndcg@5: 0.0577 ndcg@10: 0.0692 ndcg@20: 0.0855 ] 
2025-04-02 13:08:52,448 - Epoch  75 Validation set [recall@5: 0.0586 recall@10: 0.0934 recall@20: 0.1434 ] [ndcg@5: 0.0582 ndcg@10: 0.0700 ndcg@20: 0.0864 ] 
2025-04-02 13:09:08,977 - Epoch  78 Validation set [recall@5: 0.0591 recall@10: 0.0936 recall@20: 0.1435 ] [ndcg@5: 0.0584 ndcg@10: 0.0703 ndcg@20: 0.0867 ] 
2025-04-02 13:09:25,121 - Epoch  81 Validation set [recall@5: 0.0595 recall@10: 0.0934 recall@20: 0.1444 ] [ndcg@5: 0.0587 ndcg@10: 0.0704 ndcg@20: 0.0871 ] 
2025-04-02 13:09:41,525 - Epoch  84 Validation set [recall@5: 0.0594 recall@10: 0.0956 recall@20: 0.1446 ] [ndcg@5: 0.0587 ndcg@10: 0.0712 ndcg@20: 0.0872 ] 
2025-04-02 13:09:58,029 - Epoch  87 Validation set [recall@5: 0.0589 recall@10: 0.0964 recall@20: 0.1452 ] [ndcg@5: 0.0586 ndcg@10: 0.0717 ndcg@20: 0.0876 ] 
2025-04-02 13:10:14,122 - Epoch  90 Validation set [recall@5: 0.0592 recall@10: 0.0962 recall@20: 0.1457 ] [ndcg@5: 0.0589 ndcg@10: 0.0716 ndcg@20: 0.0879 ] 
2025-04-02 13:10:29,953 - Epoch  93 Validation set [recall@5: 0.0597 recall@10: 0.0967 recall@20: 0.1465 ] [ndcg@5: 0.0591 ndcg@10: 0.0718 ndcg@20: 0.0881 ] 
2025-04-02 13:10:45,852 - Epoch  96 Validation set [recall@5: 0.0594 recall@10: 0.0970 recall@20: 0.1468 ] [ndcg@5: 0.0591 ndcg@10: 0.0721 ndcg@20: 0.0885 ] 
2025-04-02 13:11:02,139 - Epoch  99 Validation set [recall@5: 0.0596 recall@10: 0.0977 recall@20: 0.1469 ] [ndcg@5: 0.0592 ndcg@10: 0.0724 ndcg@20: 0.0886 ] 
2025-04-02 13:11:25,041 - Epoch 102 Validation set [recall@5: 0.0600 recall@10: 0.0967 recall@20: 0.1474 ] [ndcg@5: 0.0595 ndcg@10: 0.0723 ndcg@20: 0.0888 ] 
2025-04-02 13:11:44,067 - Epoch 105 Validation set [recall@5: 0.0601 recall@10: 0.0966 recall@20: 0.1482 ] [ndcg@5: 0.0598 ndcg@10: 0.0721 ndcg@20: 0.0892 ] 
2025-04-02 13:12:00,566 - Epoch 108 Validation set [recall@5: 0.0604 recall@10: 0.0966 recall@20: 0.1488 ] [ndcg@5: 0.0602 ndcg@10: 0.0724 ndcg@20: 0.0896 ] 
2025-04-02 13:12:19,542 - Epoch 111 Validation set [recall@5: 0.0608 recall@10: 0.0963 recall@20: 0.1481 ] [ndcg@5: 0.0603 ndcg@10: 0.0724 ndcg@20: 0.0894 ] 
2025-04-02 13:12:34,198 - Epoch 114 Validation set [recall@5: 0.0610 recall@10: 0.0970 recall@20: 0.1491 ] [ndcg@5: 0.0603 ndcg@10: 0.0726 ndcg@20: 0.0896 ] 
2025-04-02 13:12:49,210 - Epoch 117 Validation set [recall@5: 0.0611 recall@10: 0.0978 recall@20: 0.1487 ] [ndcg@5: 0.0605 ndcg@10: 0.0731 ndcg@20: 0.0898 ] 
2025-04-02 13:13:03,951 - Epoch 120 Validation set [recall@5: 0.0621 recall@10: 0.0992 recall@20: 0.1497 ] [ndcg@5: 0.0611 ndcg@10: 0.0740 ndcg@20: 0.0905 ] 
2025-04-02 13:13:20,097 - Epoch 123 Validation set [recall@5: 0.0620 recall@10: 0.0987 recall@20: 0.1498 ] [ndcg@5: 0.0610 ndcg@10: 0.0736 ndcg@20: 0.0904 ] 
2025-04-02 13:13:36,220 - Epoch 126 Validation set [recall@5: 0.0617 recall@10: 0.0986 recall@20: 0.1490 ] [ndcg@5: 0.0610 ndcg@10: 0.0737 ndcg@20: 0.0903 ] 
2025-04-02 13:13:52,438 - Epoch 129 Validation set [recall@5: 0.0623 recall@10: 0.0992 recall@20: 0.1499 ] [ndcg@5: 0.0616 ndcg@10: 0.0742 ndcg@20: 0.0908 ] 
2025-04-02 13:14:08,760 - Epoch 132 Validation set [recall@5: 0.0624 recall@10: 0.0986 recall@20: 0.1501 ] [ndcg@5: 0.0615 ndcg@10: 0.0738 ndcg@20: 0.0907 ] 
2025-04-02 13:14:28,757 - Epoch 135 Validation set [recall@5: 0.0619 recall@10: 0.0980 recall@20: 0.1511 ] [ndcg@5: 0.0612 ndcg@10: 0.0737 ndcg@20: 0.0909 ] 
2025-04-02 13:14:52,231 - Epoch 138 Validation set [recall@5: 0.0623 recall@10: 0.0986 recall@20: 0.1504 ] [ndcg@5: 0.0616 ndcg@10: 0.0741 ndcg@20: 0.0910 ] 
2025-04-02 13:15:08,839 - Epoch 141 Validation set [recall@5: 0.0618 recall@10: 0.0995 recall@20: 0.1495 ] [ndcg@5: 0.0612 ndcg@10: 0.0743 ndcg@20: 0.0906 ] 
2025-04-02 13:15:25,022 - Epoch 144 Validation set [recall@5: 0.0630 recall@10: 0.0997 recall@20: 0.1485 ] [ndcg@5: 0.0620 ndcg@10: 0.0745 ndcg@20: 0.0905 ] 
2025-04-02 13:15:41,216 - Epoch 147 Validation set [recall@5: 0.0631 recall@10: 0.0995 recall@20: 0.1494 ] [ndcg@5: 0.0620 ndcg@10: 0.0745 ndcg@20: 0.0909 ] 
2025-04-02 13:15:57,413 - Epoch 150 Validation set [recall@5: 0.0629 recall@10: 0.0990 recall@20: 0.1492 ] [ndcg@5: 0.0622 ndcg@10: 0.0749 ndcg@20: 0.0912 ] 
2025-04-02 13:15:59,297 - [recall@5: 0.0619 recall@10: 0.0980 recall@20: 0.1511 ] [ndcg@5: 0.0612 ndcg@10: 0.0737 ndcg@20: 0.0909 ] 
2025-04-02 13:16:01,069 - [recall@5: 0.0616 recall@10: 0.0981 recall@20: 0.1482 ] [ndcg@5: 0.0615 ndcg@10: 0.0745 ndcg@20: 0.0910 ] 
2025-04-02 13:16:01,080 - Save model parameters to ./encoder/checkpoint/lightgcn_plus/lightgcn_plus-amazon-2023.pth
2025-04-02 13:16:01,080 - Best Epoch 135. Final test result: {'recall': array([0.06158845, 0.09814745, 0.14822299]), 'ndcg': array([0.06150079, 0.0744752 , 0.09096662])}.
