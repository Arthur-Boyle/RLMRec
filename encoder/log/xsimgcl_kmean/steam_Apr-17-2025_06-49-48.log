2025-04-17 06:49:48,872 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'steam', 'user_num': 23310, 'item_num': 5237}, 'model': {'name': 'xsimgcl_kmean', 'keep_rate': 1.0, 'embedding_size': 64, 'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.15, 'eps': 0.9, 'amazon': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.15, 'eps': 0.2, 'proto_reg': '8e-8', 'num_clusters': 300, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}, 'yelp': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.2, 'eps': 0.9, 'proto_reg': '8e-8', 'num_clusters': 300, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}, 'steam': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.5, 'eps': 0.2, 'proto_reg': '8e-8', 'num_clusters': 120, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}}}
2025-04-17 06:50:10,715 - Epoch   0 Validation set [recall@5: 0.0301 recall@10: 0.0487 recall@20: 0.0777 ] [ndcg@5: 0.0318 ndcg@10: 0.0380 ndcg@20: 0.0480 ] 
2025-04-17 06:50:42,435 - Epoch   3 Validation set [recall@5: 0.0365 recall@10: 0.0610 recall@20: 0.0985 ] [ndcg@5: 0.0378 ndcg@10: 0.0466 ndcg@20: 0.0596 ] 
2025-04-17 06:51:06,911 - Epoch   6 Validation set [recall@5: 0.0389 recall@10: 0.0644 recall@20: 0.1021 ] [ndcg@5: 0.0409 ndcg@10: 0.0496 ndcg@20: 0.0626 ] 
2025-04-17 06:51:38,833 - Epoch   9 Validation set [recall@5: 0.0392 recall@10: 0.0640 recall@20: 0.1021 ] [ndcg@5: 0.0420 ndcg@10: 0.0504 ndcg@20: 0.0634 ] 
2025-04-17 06:52:11,316 - Epoch  12 Validation set [recall@5: 0.0388 recall@10: 0.0638 recall@20: 0.1007 ] [ndcg@5: 0.0420 ndcg@10: 0.0504 ndcg@20: 0.0629 ] 
2025-04-17 06:52:42,198 - Epoch  15 Validation set [recall@5: 0.0382 recall@10: 0.0615 recall@20: 0.0981 ] [ndcg@5: 0.0412 ndcg@10: 0.0488 ndcg@20: 0.0611 ] 
2025-04-17 06:53:10,124 - Epoch  18 Validation set [recall@5: 0.0373 recall@10: 0.0602 recall@20: 0.0957 ] [ndcg@5: 0.0405 ndcg@10: 0.0480 ndcg@20: 0.0599 ] 
2025-04-17 06:53:41,238 - Epoch  21 Validation set [recall@5: 0.0355 recall@10: 0.0579 recall@20: 0.0929 ] [ndcg@5: 0.0391 ndcg@10: 0.0464 ndcg@20: 0.0580 ] 
2025-04-17 06:54:13,057 - Epoch  24 Validation set [recall@5: 0.0347 recall@10: 0.0567 recall@20: 0.0904 ] [ndcg@5: 0.0380 ndcg@10: 0.0453 ndcg@20: 0.0564 ] 
2025-04-17 06:54:17,445 - [recall@5: 0.0392 recall@10: 0.0640 recall@20: 0.1021 ] [ndcg@5: 0.0420 ndcg@10: 0.0504 ndcg@20: 0.0634 ] 
2025-04-17 06:54:21,748 - [recall@5: 0.0380 recall@10: 0.0623 recall@20: 0.0997 ] [ndcg@5: 0.0407 ndcg@10: 0.0492 ndcg@20: 0.0620 ] 
2025-04-17 06:54:21,749 - Best Epoch 9. Final test result: {'recall': array([0.0379542 , 0.0622899 , 0.09966359]), 'ndcg': array([0.04074307, 0.04921664, 0.06200842])}.
k = 120