2025-04-17 05:03:37,171 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'steam', 'user_num': 23310, 'item_num': 5237}, 'model': {'name': 'xsimgcl_kmean', 'keep_rate': 1.0, 'embedding_size': 64, 'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.15, 'eps': 0.9, 'amazon': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.15, 'eps': 0.2, 'proto_reg': '8e-8', 'num_clusters': 300, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}, 'yelp': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.2, 'eps': 0.9, 'proto_reg': '8e-8', 'num_clusters': 300, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}, 'steam': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.5, 'eps': 0.2, 'proto_reg': '8e-8', 'num_clusters': 300, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}}}
2025-04-17 05:03:50,384 - Epoch   0 Validation set [recall@5: 0.0298 recall@10: 0.0478 recall@20: 0.0767 ] [ndcg@5: 0.0316 ndcg@10: 0.0377 ndcg@20: 0.0477 ] 
2025-04-17 05:04:03,685 - Epoch   3 Validation set [recall@5: 0.0361 recall@10: 0.0608 recall@20: 0.0973 ] [ndcg@5: 0.0373 ndcg@10: 0.0462 ndcg@20: 0.0588 ] 
2025-04-17 05:04:17,293 - Epoch   6 Validation set [recall@5: 0.0379 recall@10: 0.0644 recall@20: 0.1024 ] [ndcg@5: 0.0404 ndcg@10: 0.0498 ndcg@20: 0.0628 ] 
2025-04-17 05:04:30,877 - Epoch   9 Validation set [recall@5: 0.0392 recall@10: 0.0636 recall@20: 0.1008 ] [ndcg@5: 0.0418 ndcg@10: 0.0501 ndcg@20: 0.0627 ] 
2025-04-17 05:04:44,040 - Epoch  12 Validation set [recall@5: 0.0387 recall@10: 0.0623 recall@20: 0.0985 ] [ndcg@5: 0.0418 ndcg@10: 0.0496 ndcg@20: 0.0619 ] 
2025-04-17 05:04:57,909 - Epoch  15 Validation set [recall@5: 0.0373 recall@10: 0.0604 recall@20: 0.0955 ] [ndcg@5: 0.0404 ndcg@10: 0.0481 ndcg@20: 0.0599 ] 
2025-04-17 05:05:13,973 - Epoch  18 Validation set [recall@5: 0.0358 recall@10: 0.0584 recall@20: 0.0921 ] [ndcg@5: 0.0391 ndcg@10: 0.0466 ndcg@20: 0.0578 ] 
2025-04-17 05:05:28,973 - Epoch  21 Validation set [recall@5: 0.0345 recall@10: 0.0564 recall@20: 0.0893 ] [ndcg@5: 0.0381 ndcg@10: 0.0453 ndcg@20: 0.0562 ] 
2025-04-17 05:05:32,973 - [recall@5: 0.0379 recall@10: 0.0644 recall@20: 0.1024 ] [ndcg@5: 0.0404 ndcg@10: 0.0498 ndcg@20: 0.0628 ] 
2025-04-17 05:05:37,355 - [recall@5: 0.0383 recall@10: 0.0621 recall@20: 0.1004 ] [ndcg@5: 0.0398 ndcg@10: 0.0483 ndcg@20: 0.0613 ] 
2025-04-17 05:05:37,356 - Best Epoch 6. Final test result: {'recall': array([0.03831758, 0.06212909, 0.10035101]), 'ndcg': array([0.03983099, 0.04826692, 0.06134929])}.
k = 300