2025-04-17 06:41:58,546 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'steam', 'user_num': 23310, 'item_num': 5237}, 'model': {'name': 'xsimgcl_kmean', 'keep_rate': 1.0, 'embedding_size': 64, 'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.15, 'eps': 0.9, 'amazon': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.15, 'eps': 0.2, 'proto_reg': '8e-8', 'num_clusters': 300, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}, 'yelp': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.2, 'eps': 0.9, 'proto_reg': '8e-8', 'num_clusters': 300, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}, 'steam': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.5, 'eps': 0.2, 'proto_reg': '8e-8', 'num_clusters': 150, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}}}
2025-04-17 06:42:11,271 - Epoch   0 Validation set [recall@5: 0.0295 recall@10: 0.0481 recall@20: 0.0779 ] [ndcg@5: 0.0316 ndcg@10: 0.0379 ndcg@20: 0.0481 ] 
2025-04-17 06:42:24,395 - Epoch   3 Validation set [recall@5: 0.0361 recall@10: 0.0605 recall@20: 0.0977 ] [ndcg@5: 0.0377 ndcg@10: 0.0463 ndcg@20: 0.0592 ] 
2025-04-17 06:42:41,400 - Epoch   6 Validation set [recall@5: 0.0386 recall@10: 0.0631 recall@20: 0.1012 ] [ndcg@5: 0.0409 ndcg@10: 0.0492 ndcg@20: 0.0623 ] 
2025-04-17 06:43:12,880 - Epoch   9 Validation set [recall@5: 0.0391 recall@10: 0.0633 recall@20: 0.1014 ] [ndcg@5: 0.0420 ndcg@10: 0.0502 ndcg@20: 0.0631 ] 
2025-04-17 06:43:48,156 - Epoch  12 Validation set [recall@5: 0.0390 recall@10: 0.0630 recall@20: 0.1002 ] [ndcg@5: 0.0423 ndcg@10: 0.0502 ndcg@20: 0.0627 ] 
2025-04-17 06:44:23,636 - Epoch  15 Validation set [recall@5: 0.0380 recall@10: 0.0616 recall@20: 0.0970 ] [ndcg@5: 0.0413 ndcg@10: 0.0490 ndcg@20: 0.0609 ] 
2025-04-17 06:44:51,962 - Epoch  18 Validation set [recall@5: 0.0367 recall@10: 0.0601 recall@20: 0.0948 ] [ndcg@5: 0.0405 ndcg@10: 0.0482 ndcg@20: 0.0597 ] 
2025-04-17 06:45:07,150 - Epoch  21 Validation set [recall@5: 0.0352 recall@10: 0.0572 recall@20: 0.0919 ] [ndcg@5: 0.0389 ndcg@10: 0.0461 ndcg@20: 0.0577 ] 
2025-04-17 06:45:21,966 - Epoch  24 Validation set [recall@5: 0.0340 recall@10: 0.0558 recall@20: 0.0889 ] [ndcg@5: 0.0375 ndcg@10: 0.0447 ndcg@20: 0.0556 ] 
2025-04-17 06:45:26,355 - [recall@5: 0.0391 recall@10: 0.0633 recall@20: 0.1014 ] [ndcg@5: 0.0420 ndcg@10: 0.0502 ndcg@20: 0.0631 ] 
2025-04-17 06:45:30,638 - [recall@5: 0.0383 recall@10: 0.0618 recall@20: 0.0991 ] [ndcg@5: 0.0406 ndcg@10: 0.0487 ndcg@20: 0.0615 ] 
2025-04-17 06:45:30,638 - Best Epoch 9. Final test result: {'recall': array([0.03828816, 0.06179046, 0.09910254]), 'ndcg': array([0.04055049, 0.04870762, 0.06147724])}.
k = 150