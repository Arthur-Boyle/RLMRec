2025-04-16 08:22:47,607 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'xsimgcl_kmean', 'keep_rate': 1.0, 'embedding_size': 64, 'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.15, 'eps': 0.9, 'amazon': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.15, 'eps': 0.2, 'proto_reg': '8e-8', 'num_clusters': 300, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}, 'yelp': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.2, 'eps': 0.9}, 'steam': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.5, 'eps': 0.2}}}
2025-04-16 08:23:14,333 - Epoch   0 Validation set [recall@5: 0.0324 recall@10: 0.0474 recall@20: 0.0692 ] [ndcg@5: 0.0317 ndcg@10: 0.0369 ndcg@20: 0.0440 ] 
2025-04-16 08:23:19,143 - Epoch   3 Validation set [recall@5: 0.0537 recall@10: 0.0776 recall@20: 0.1067 ] [ndcg@5: 0.0531 ndcg@10: 0.0608 ndcg@20: 0.0702 ] 
2025-04-16 08:23:24,141 - Epoch   6 Validation set [recall@5: 0.0576 recall@10: 0.0859 recall@20: 0.1192 ] [ndcg@5: 0.0585 ndcg@10: 0.0678 ndcg@20: 0.0786 ] 
2025-04-16 08:23:28,656 - Epoch   9 Validation set [recall@5: 0.0623 recall@10: 0.0908 recall@20: 0.1266 ] [ndcg@5: 0.0630 ndcg@10: 0.0721 ndcg@20: 0.0836 ] 
2025-04-16 08:23:33,508 - Epoch  12 Validation set [recall@5: 0.0661 recall@10: 0.0954 recall@20: 0.1308 ] [ndcg@5: 0.0661 ndcg@10: 0.0758 ndcg@20: 0.0872 ] 
2025-04-16 08:23:38,443 - Epoch  15 Validation set [recall@5: 0.0680 recall@10: 0.0967 recall@20: 0.1344 ] [ndcg@5: 0.0683 ndcg@10: 0.0773 ndcg@20: 0.0896 ] 
2025-04-16 08:23:43,394 - Epoch  18 Validation set [recall@5: 0.0689 recall@10: 0.0994 recall@20: 0.1389 ] [ndcg@5: 0.0695 ndcg@10: 0.0791 ndcg@20: 0.0918 ] 
2025-04-16 08:23:48,356 - Epoch  21 Validation set [recall@5: 0.0684 recall@10: 0.1009 recall@20: 0.1398 ] [ndcg@5: 0.0698 ndcg@10: 0.0801 ndcg@20: 0.0928 ] 
2025-04-16 08:23:53,021 - Epoch  24 Validation set [recall@5: 0.0693 recall@10: 0.0995 recall@20: 0.1416 ] [ndcg@5: 0.0704 ndcg@10: 0.0800 ndcg@20: 0.0936 ] 
2025-04-16 08:23:57,835 - Epoch  27 Validation set [recall@5: 0.0694 recall@10: 0.1004 recall@20: 0.1419 ] [ndcg@5: 0.0709 ndcg@10: 0.0806 ndcg@20: 0.0940 ] 
2025-04-16 08:24:02,816 - Epoch  30 Validation set [recall@5: 0.0693 recall@10: 0.1004 recall@20: 0.1424 ] [ndcg@5: 0.0712 ndcg@10: 0.0809 ndcg@20: 0.0945 ] 
2025-04-16 08:24:07,904 - Epoch  33 Validation set [recall@5: 0.0687 recall@10: 0.1003 recall@20: 0.1431 ] [ndcg@5: 0.0707 ndcg@10: 0.0806 ndcg@20: 0.0944 ] 
2025-04-16 08:24:12,560 - Epoch  36 Validation set [recall@5: 0.0689 recall@10: 0.1002 recall@20: 0.1438 ] [ndcg@5: 0.0710 ndcg@10: 0.0808 ndcg@20: 0.0948 ] 
2025-04-16 08:24:17,581 - Epoch  39 Validation set [recall@5: 0.0689 recall@10: 0.0997 recall@20: 0.1428 ] [ndcg@5: 0.0713 ndcg@10: 0.0808 ndcg@20: 0.0948 ] 
2025-04-16 08:24:22,307 - Epoch  42 Validation set [recall@5: 0.0687 recall@10: 0.1008 recall@20: 0.1442 ] [ndcg@5: 0.0712 ndcg@10: 0.0813 ndcg@20: 0.0952 ] 
2025-04-16 08:24:26,934 - Epoch  45 Validation set [recall@5: 0.0686 recall@10: 0.1010 recall@20: 0.1454 ] [ndcg@5: 0.0712 ndcg@10: 0.0813 ndcg@20: 0.0956 ] 
2025-04-16 08:24:31,535 - Epoch  48 Validation set [recall@5: 0.0692 recall@10: 0.1017 recall@20: 0.1455 ] [ndcg@5: 0.0714 ndcg@10: 0.0819 ndcg@20: 0.0958 ] 
2025-04-16 08:24:36,495 - Epoch  51 Validation set [recall@5: 0.0697 recall@10: 0.1019 recall@20: 0.1455 ] [ndcg@5: 0.0717 ndcg@10: 0.0819 ndcg@20: 0.0959 ] 
2025-04-16 08:24:41,133 - Epoch  54 Validation set [recall@5: 0.0693 recall@10: 0.1019 recall@20: 0.1450 ] [ndcg@5: 0.0715 ndcg@10: 0.0819 ndcg@20: 0.0958 ] 
2025-04-16 08:24:46,539 - Epoch  57 Validation set [recall@5: 0.0693 recall@10: 0.1021 recall@20: 0.1466 ] [ndcg@5: 0.0717 ndcg@10: 0.0822 ndcg@20: 0.0964 ] 
2025-04-16 08:24:51,359 - Epoch  60 Validation set [recall@5: 0.0694 recall@10: 0.1023 recall@20: 0.1457 ] [ndcg@5: 0.0717 ndcg@10: 0.0822 ndcg@20: 0.0960 ] 
2025-04-16 08:24:56,000 - Epoch  63 Validation set [recall@5: 0.0697 recall@10: 0.1025 recall@20: 0.1460 ] [ndcg@5: 0.0721 ndcg@10: 0.0825 ndcg@20: 0.0964 ] 
2025-04-16 08:25:00,552 - Epoch  66 Validation set [recall@5: 0.0692 recall@10: 0.1023 recall@20: 0.1465 ] [ndcg@5: 0.0717 ndcg@10: 0.0824 ndcg@20: 0.0965 ] 
2025-04-16 08:25:05,265 - Epoch  69 Validation set [recall@5: 0.0700 recall@10: 0.1038 recall@20: 0.1458 ] [ndcg@5: 0.0722 ndcg@10: 0.0829 ndcg@20: 0.0963 ] 
2025-04-16 08:25:10,009 - Epoch  72 Validation set [recall@5: 0.0700 recall@10: 0.1027 recall@20: 0.1458 ] [ndcg@5: 0.0721 ndcg@10: 0.0826 ndcg@20: 0.0962 ] 
2025-04-16 08:25:11,693 - [recall@5: 0.0693 recall@10: 0.1021 recall@20: 0.1466 ] [ndcg@5: 0.0717 ndcg@10: 0.0822 ndcg@20: 0.0964 ] 
2025-04-16 08:25:13,604 - [recall@5: 0.0667 recall@10: 0.1003 recall@20: 0.1443 ] [ndcg@5: 0.0705 ndcg@10: 0.0809 ndcg@20: 0.0949 ] 
2025-04-16 08:25:13,604 - Best Epoch 57. Final test result: {'recall': array([0.06665875, 0.10030588, 0.14427717]), 'ndcg': array([0.07052856, 0.08091358, 0.09489862])}.
num_clusters: 300