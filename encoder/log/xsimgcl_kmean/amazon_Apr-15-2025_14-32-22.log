2025-04-15 14:32:22,990 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'xsimgcl_kmean', 'keep_rate': 1.0, 'embedding_size': 64, 'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.15, 'eps': 0.9, 'amazon': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.15, 'eps': 0.2, 'proto_reg': '8e-8', 'num_clusters': 200, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}, 'yelp': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.2, 'eps': 0.9}, 'steam': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.5, 'eps': 0.2}}}
2025-04-15 14:32:31,700 - Epoch   0 Validation set [recall@5: 0.0327 recall@10: 0.0479 recall@20: 0.0696 ] [ndcg@5: 0.0320 ndcg@10: 0.0372 ndcg@20: 0.0442 ] 
2025-04-15 14:32:36,953 - Epoch   3 Validation set [recall@5: 0.0540 recall@10: 0.0771 recall@20: 0.1066 ] [ndcg@5: 0.0534 ndcg@10: 0.0608 ndcg@20: 0.0703 ] 
2025-04-15 14:32:41,673 - Epoch   6 Validation set [recall@5: 0.0590 recall@10: 0.0848 recall@20: 0.1191 ] [ndcg@5: 0.0592 ndcg@10: 0.0677 ndcg@20: 0.0787 ] 
2025-04-15 14:32:46,592 - Epoch   9 Validation set [recall@5: 0.0630 recall@10: 0.0905 recall@20: 0.1258 ] [ndcg@5: 0.0631 ndcg@10: 0.0721 ndcg@20: 0.0834 ] 
2025-04-15 14:32:51,388 - Epoch  12 Validation set [recall@5: 0.0670 recall@10: 0.0944 recall@20: 0.1309 ] [ndcg@5: 0.0670 ndcg@10: 0.0756 ndcg@20: 0.0873 ] 
2025-04-15 14:32:56,107 - Epoch  15 Validation set [recall@5: 0.0688 recall@10: 0.0967 recall@20: 0.1351 ] [ndcg@5: 0.0688 ndcg@10: 0.0775 ndcg@20: 0.0899 ] 
2025-04-15 14:33:00,772 - Epoch  18 Validation set [recall@5: 0.0695 recall@10: 0.0974 recall@20: 0.1375 ] [ndcg@5: 0.0698 ndcg@10: 0.0784 ndcg@20: 0.0915 ] 
2025-04-15 14:33:05,526 - Epoch  21 Validation set [recall@5: 0.0697 recall@10: 0.0984 recall@20: 0.1392 ] [ndcg@5: 0.0704 ndcg@10: 0.0794 ndcg@20: 0.0926 ] 
2025-04-15 14:33:10,343 - Epoch  24 Validation set [recall@5: 0.0694 recall@10: 0.0984 recall@20: 0.1402 ] [ndcg@5: 0.0708 ndcg@10: 0.0798 ndcg@20: 0.0932 ] 
2025-04-15 14:33:15,122 - Epoch  27 Validation set [recall@5: 0.0697 recall@10: 0.0998 recall@20: 0.1412 ] [ndcg@5: 0.0710 ndcg@10: 0.0803 ndcg@20: 0.0938 ] 
2025-04-15 14:33:19,844 - Epoch  30 Validation set [recall@5: 0.0692 recall@10: 0.0997 recall@20: 0.1416 ] [ndcg@5: 0.0707 ndcg@10: 0.0802 ndcg@20: 0.0937 ] 
2025-04-15 14:33:24,857 - Epoch  33 Validation set [recall@5: 0.0687 recall@10: 0.0994 recall@20: 0.1423 ] [ndcg@5: 0.0706 ndcg@10: 0.0800 ndcg@20: 0.0939 ] 
2025-04-15 14:33:29,707 - Epoch  36 Validation set [recall@5: 0.0693 recall@10: 0.0991 recall@20: 0.1417 ] [ndcg@5: 0.0708 ndcg@10: 0.0800 ndcg@20: 0.0937 ] 
2025-04-15 14:33:34,480 - Epoch  39 Validation set [recall@5: 0.0683 recall@10: 0.0990 recall@20: 0.1427 ] [ndcg@5: 0.0707 ndcg@10: 0.0801 ndcg@20: 0.0941 ] 
2025-04-15 14:33:40,013 - Epoch  42 Validation set [recall@5: 0.0676 recall@10: 0.0997 recall@20: 0.1445 ] [ndcg@5: 0.0703 ndcg@10: 0.0803 ndcg@20: 0.0946 ] 
2025-04-15 14:33:45,204 - Epoch  45 Validation set [recall@5: 0.0673 recall@10: 0.1001 recall@20: 0.1449 ] [ndcg@5: 0.0703 ndcg@10: 0.0805 ndcg@20: 0.0948 ] 
2025-04-15 14:33:50,144 - Epoch  48 Validation set [recall@5: 0.0681 recall@10: 0.1005 recall@20: 0.1450 ] [ndcg@5: 0.0707 ndcg@10: 0.0810 ndcg@20: 0.0952 ] 
2025-04-15 14:33:55,386 - Epoch  51 Validation set [recall@5: 0.0676 recall@10: 0.1013 recall@20: 0.1462 ] [ndcg@5: 0.0705 ndcg@10: 0.0812 ndcg@20: 0.0955 ] 
2025-04-15 14:34:00,318 - Epoch  54 Validation set [recall@5: 0.0679 recall@10: 0.1018 recall@20: 0.1454 ] [ndcg@5: 0.0706 ndcg@10: 0.0816 ndcg@20: 0.0954 ] 
2025-04-15 14:34:05,161 - Epoch  57 Validation set [recall@5: 0.0686 recall@10: 0.1027 recall@20: 0.1458 ] [ndcg@5: 0.0709 ndcg@10: 0.0819 ndcg@20: 0.0956 ] 
2025-04-15 14:34:09,865 - Epoch  60 Validation set [recall@5: 0.0682 recall@10: 0.1030 recall@20: 0.1451 ] [ndcg@5: 0.0709 ndcg@10: 0.0824 ndcg@20: 0.0956 ] 
2025-04-15 14:34:14,562 - Epoch  63 Validation set [recall@5: 0.0688 recall@10: 0.1030 recall@20: 0.1459 ] [ndcg@5: 0.0713 ndcg@10: 0.0823 ndcg@20: 0.0960 ] 
2025-04-15 14:34:19,755 - Epoch  66 Validation set [recall@5: 0.0692 recall@10: 0.1027 recall@20: 0.1458 ] [ndcg@5: 0.0716 ndcg@10: 0.0823 ndcg@20: 0.0960 ] 
2025-04-15 14:34:21,762 - [recall@5: 0.0676 recall@10: 0.1013 recall@20: 0.1462 ] [ndcg@5: 0.0705 ndcg@10: 0.0812 ndcg@20: 0.0955 ] 
2025-04-15 14:34:23,694 - [recall@5: 0.0677 recall@10: 0.1003 recall@20: 0.1426 ] [ndcg@5: 0.0705 ndcg@10: 0.0808 ndcg@20: 0.0943 ] 
2025-04-15 14:34:23,695 - Best Epoch 51. Final test result: {'recall': array([0.06771873, 0.10025851, 0.14264844]), 'ndcg': array([0.07051043, 0.08083981, 0.09433544])}.
num_clusters: 200