2025-04-11 04:25:08,583 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': True, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'sgl_plus', 'keep_rate': 0.8, 'embedding_size': 32, 'augmentation': 'edge_drop', 'layer_num': 3, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'cl_temperature': 0.2, 'kd_weight': 0.01, 'kd_temperature': 0.5, 'amazon': {'layer_num': 3, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'cl_temperature': 0.2, 'kd_weight': 0.01, 'kd_temperature': 0.5}, 'yelp': {'layer_num': 3, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'cl_temperature': 0.2, 'kd_weight': 0.01, 'kd_temperature': 1.0}, 'steam': {'layer_num': 3, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'cl_temperature': 0.5, 'kd_weight': 0.01, 'kd_temperature': 1.0}}}
2025-04-11 04:25:40,972 - Epoch   0 Validation set [recall@5: 0.0149 recall@10: 0.0230 recall@20: 0.0373 ] [ndcg@5: 0.0154 ndcg@10: 0.0179 ndcg@20: 0.0224 ] 
2025-04-11 04:27:04,426 - Epoch   3 Validation set [recall@5: 0.0284 recall@10: 0.0465 recall@20: 0.0718 ] [ndcg@5: 0.0286 ndcg@10: 0.0348 ndcg@20: 0.0430 ] 
2025-04-11 04:28:27,083 - Epoch   6 Validation set [recall@5: 0.0213 recall@10: 0.0355 recall@20: 0.0614 ] [ndcg@5: 0.0218 ndcg@10: 0.0268 ndcg@20: 0.0351 ] 
2025-04-11 04:29:43,389 - Epoch   9 Validation set [recall@5: 0.0224 recall@10: 0.0396 recall@20: 0.0651 ] [ndcg@5: 0.0244 ndcg@10: 0.0303 ndcg@20: 0.0384 ] 
2025-04-11 04:31:00,098 - Epoch  12 Validation set [recall@5: 0.0423 recall@10: 0.0692 recall@20: 0.1059 ] [ndcg@5: 0.0439 ndcg@10: 0.0530 ndcg@20: 0.0650 ] 
2025-04-11 04:32:25,279 - Epoch  15 Validation set [recall@5: 0.0581 recall@10: 0.0919 recall@20: 0.1347 ] [ndcg@5: 0.0579 ndcg@10: 0.0696 ndcg@20: 0.0836 ] 
2025-04-11 04:33:53,406 - Epoch  18 Validation set [recall@5: 0.0638 recall@10: 0.0996 recall@20: 0.1461 ] [ndcg@5: 0.0632 ndcg@10: 0.0754 ndcg@20: 0.0908 ] 
2025-04-11 04:35:11,984 - Epoch  21 Validation set [recall@5: 0.0666 recall@10: 0.1030 recall@20: 0.1524 ] [ndcg@5: 0.0660 ndcg@10: 0.0783 ndcg@20: 0.0945 ] 
2025-04-11 04:36:33,033 - Epoch  24 Validation set [recall@5: 0.0667 recall@10: 0.1041 recall@20: 0.1547 ] [ndcg@5: 0.0665 ndcg@10: 0.0794 ndcg@20: 0.0959 ] 
2025-04-11 04:38:02,259 - Epoch  27 Validation set [recall@5: 0.0669 recall@10: 0.1049 recall@20: 0.1564 ] [ndcg@5: 0.0668 ndcg@10: 0.0800 ndcg@20: 0.0968 ] 
2025-04-11 04:39:19,653 - Epoch  30 Validation set [recall@5: 0.0671 recall@10: 0.1051 recall@20: 0.1567 ] [ndcg@5: 0.0669 ndcg@10: 0.0800 ndcg@20: 0.0968 ] 
2025-04-11 04:40:35,793 - Epoch  33 Validation set [recall@5: 0.0674 recall@10: 0.1050 recall@20: 0.1567 ] [ndcg@5: 0.0672 ndcg@10: 0.0800 ndcg@20: 0.0970 ] 
2025-04-11 04:41:49,231 - Epoch  36 Validation set [recall@5: 0.0672 recall@10: 0.1055 recall@20: 0.1567 ] [ndcg@5: 0.0668 ndcg@10: 0.0799 ndcg@20: 0.0967 ] 
2025-04-11 04:42:59,214 - Epoch  39 Validation set [recall@5: 0.0669 recall@10: 0.1053 recall@20: 0.1562 ] [ndcg@5: 0.0669 ndcg@10: 0.0800 ndcg@20: 0.0966 ] 
2025-04-11 04:44:23,106 - Epoch  42 Validation set [recall@5: 0.0674 recall@10: 0.1051 recall@20: 0.1563 ] [ndcg@5: 0.0669 ndcg@10: 0.0797 ndcg@20: 0.0964 ] 
2025-04-11 04:45:37,398 - Epoch  45 Validation set [recall@5: 0.0677 recall@10: 0.1043 recall@20: 0.1557 ] [ndcg@5: 0.0667 ndcg@10: 0.0793 ndcg@20: 0.0962 ] 
2025-04-11 04:46:44,404 - Epoch  48 Validation set [recall@5: 0.0677 recall@10: 0.1040 recall@20: 0.1565 ] [ndcg@5: 0.0666 ndcg@10: 0.0791 ndcg@20: 0.0961 ] 
2025-04-11 04:47:50,862 - Epoch  51 Validation set [recall@5: 0.0677 recall@10: 0.1034 recall@20: 0.1568 ] [ndcg@5: 0.0665 ndcg@10: 0.0786 ndcg@20: 0.0960 ] 
2025-04-11 04:48:59,219 - Epoch  54 Validation set [recall@5: 0.0673 recall@10: 0.1028 recall@20: 0.1557 ] [ndcg@5: 0.0664 ndcg@10: 0.0786 ndcg@20: 0.0958 ] 
2025-04-11 04:50:19,106 - Epoch  57 Validation set [recall@5: 0.0670 recall@10: 0.1034 recall@20: 0.1557 ] [ndcg@5: 0.0664 ndcg@10: 0.0789 ndcg@20: 0.0959 ] 
2025-04-11 04:51:37,453 - Epoch  60 Validation set [recall@5: 0.0664 recall@10: 0.1036 recall@20: 0.1566 ] [ndcg@5: 0.0663 ndcg@10: 0.0792 ndcg@20: 0.0964 ] 
2025-04-11 04:52:52,755 - Epoch  63 Validation set [recall@5: 0.0658 recall@10: 0.1037 recall@20: 0.1569 ] [ndcg@5: 0.0660 ndcg@10: 0.0790 ndcg@20: 0.0963 ] 
2025-04-11 04:54:26,060 - Epoch  66 Validation set [recall@5: 0.0664 recall@10: 0.1039 recall@20: 0.1573 ] [ndcg@5: 0.0661 ndcg@10: 0.0790 ndcg@20: 0.0962 ] 
2025-04-11 04:56:01,113 - Epoch  69 Validation set [recall@5: 0.0668 recall@10: 0.1038 recall@20: 0.1567 ] [ndcg@5: 0.0661 ndcg@10: 0.0788 ndcg@20: 0.0960 ] 
2025-04-11 04:57:35,610 - Epoch  72 Validation set [recall@5: 0.0671 recall@10: 0.1043 recall@20: 0.1569 ] [ndcg@5: 0.0661 ndcg@10: 0.0789 ndcg@20: 0.0959 ] 
2025-04-11 04:58:49,207 - Epoch  75 Validation set [recall@5: 0.0671 recall@10: 0.1038 recall@20: 0.1569 ] [ndcg@5: 0.0660 ndcg@10: 0.0787 ndcg@20: 0.0959 ] 
2025-04-11 04:59:57,397 - Epoch  78 Validation set [recall@5: 0.0676 recall@10: 0.1038 recall@20: 0.1559 ] [ndcg@5: 0.0664 ndcg@10: 0.0788 ndcg@20: 0.0958 ] 
2025-04-11 05:01:06,763 - Epoch  81 Validation set [recall@5: 0.0671 recall@10: 0.1049 recall@20: 0.1560 ] [ndcg@5: 0.0664 ndcg@10: 0.0794 ndcg@20: 0.0960 ] 
2025-04-11 05:01:08,963 - [recall@5: 0.0664 recall@10: 0.1039 recall@20: 0.1573 ] [ndcg@5: 0.0661 ndcg@10: 0.0790 ndcg@20: 0.0962 ] 
2025-04-11 05:01:10,972 - [recall@5: 0.0642 recall@10: 0.1009 recall@20: 0.1511 ] [ndcg@5: 0.0648 ndcg@10: 0.0773 ndcg@20: 0.0938 ] 
2025-04-11 05:01:10,985 - Save model parameters to ./encoder/checkpoint/sgl_plus/sgl_plus-amazon-2023.pth
2025-04-11 05:01:10,985 - Best Epoch 66. Final test result: {'recall': array([0.06416625, 0.1008679 , 0.15109909]), 'ndcg': array([0.0648191 , 0.07734237, 0.09376493])}.
原版