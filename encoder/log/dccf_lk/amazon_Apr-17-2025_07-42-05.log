2025-04-17 07:42:05,404 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'dccf_lk', 'embedding_size': 64, 'intent_num': 128, 'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.15, 'amazon': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.15, 'proto_reg': '8e-8', 'num_clusters': 300, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}, 'yelp': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1}, 'steam': {'layer_num': 3, 'reg_weight': 0.001, 'cl_weight': 0.001, 'temperature': 0.15}}}
2025-04-17 07:42:16,091 - Epoch   0 Validation set [recall@5: 0.0334 recall@10: 0.0561 recall@20: 0.0873 ] [ndcg@5: 0.0331 ndcg@10: 0.0412 ndcg@20: 0.0513 ] 
2025-04-17 07:42:24,324 - Epoch   3 Validation set [recall@5: 0.0592 recall@10: 0.0918 recall@20: 0.1360 ] [ndcg@5: 0.0581 ndcg@10: 0.0691 ndcg@20: 0.0836 ] 
2025-04-17 07:42:32,891 - Epoch   6 Validation set [recall@5: 0.0646 recall@10: 0.1008 recall@20: 0.1501 ] [ndcg@5: 0.0641 ndcg@10: 0.0764 ndcg@20: 0.0923 ] 
2025-04-17 07:42:41,434 - Epoch   9 Validation set [recall@5: 0.0684 recall@10: 0.1029 recall@20: 0.1535 ] [ndcg@5: 0.0679 ndcg@10: 0.0794 ndcg@20: 0.0958 ] 
2025-04-17 07:42:49,636 - Epoch  12 Validation set [recall@5: 0.0704 recall@10: 0.1071 recall@20: 0.1582 ] [ndcg@5: 0.0691 ndcg@10: 0.0819 ndcg@20: 0.0986 ] 
2025-04-17 07:42:57,729 - Epoch  15 Validation set [recall@5: 0.0705 recall@10: 0.1093 recall@20: 0.1602 ] [ndcg@5: 0.0704 ndcg@10: 0.0835 ndcg@20: 0.1002 ] 
2025-04-17 07:43:05,862 - Epoch  18 Validation set [recall@5: 0.0728 recall@10: 0.1100 recall@20: 0.1619 ] [ndcg@5: 0.0718 ndcg@10: 0.0843 ndcg@20: 0.1013 ] 
2025-04-17 07:43:14,219 - Epoch  21 Validation set [recall@5: 0.0730 recall@10: 0.1105 recall@20: 0.1632 ] [ndcg@5: 0.0718 ndcg@10: 0.0846 ndcg@20: 0.1017 ] 
2025-04-17 07:43:22,626 - Epoch  24 Validation set [recall@5: 0.0726 recall@10: 0.1113 recall@20: 0.1634 ] [ndcg@5: 0.0725 ndcg@10: 0.0853 ndcg@20: 0.1026 ] 
2025-04-17 07:43:30,732 - Epoch  27 Validation set [recall@5: 0.0729 recall@10: 0.1122 recall@20: 0.1640 ] [ndcg@5: 0.0728 ndcg@10: 0.0861 ndcg@20: 0.1031 ] 
2025-04-17 07:43:39,141 - Epoch  30 Validation set [recall@5: 0.0732 recall@10: 0.1118 recall@20: 0.1641 ] [ndcg@5: 0.0716 ndcg@10: 0.0849 ndcg@20: 0.1022 ] 
2025-04-17 07:43:47,546 - Epoch  33 Validation set [recall@5: 0.0735 recall@10: 0.1135 recall@20: 0.1655 ] [ndcg@5: 0.0731 ndcg@10: 0.0868 ndcg@20: 0.1038 ] 
2025-04-17 07:43:56,155 - Epoch  36 Validation set [recall@5: 0.0752 recall@10: 0.1134 recall@20: 0.1667 ] [ndcg@5: 0.0740 ndcg@10: 0.0873 ndcg@20: 0.1047 ] 
2025-04-17 07:44:03,982 - Epoch  39 Validation set [recall@5: 0.0737 recall@10: 0.1126 recall@20: 0.1673 ] [ndcg@5: 0.0732 ndcg@10: 0.0868 ndcg@20: 0.1047 ] 
2025-04-17 07:44:12,489 - Epoch  42 Validation set [recall@5: 0.0742 recall@10: 0.1126 recall@20: 0.1685 ] [ndcg@5: 0.0731 ndcg@10: 0.0863 ndcg@20: 0.1044 ] 
2025-04-17 07:44:20,734 - Epoch  45 Validation set [recall@5: 0.0740 recall@10: 0.1135 recall@20: 0.1665 ] [ndcg@5: 0.0737 ndcg@10: 0.0872 ndcg@20: 0.1044 ] 
2025-04-17 07:44:28,852 - Epoch  48 Validation set [recall@5: 0.0751 recall@10: 0.1141 recall@20: 0.1666 ] [ndcg@5: 0.0745 ndcg@10: 0.0877 ndcg@20: 0.1048 ] 
2025-04-17 07:44:37,369 - Epoch  51 Validation set [recall@5: 0.0730 recall@10: 0.1127 recall@20: 0.1656 ] [ndcg@5: 0.0731 ndcg@10: 0.0869 ndcg@20: 0.1040 ] 
2025-04-17 07:44:46,019 - Epoch  54 Validation set [recall@5: 0.0758 recall@10: 0.1138 recall@20: 0.1677 ] [ndcg@5: 0.0743 ndcg@10: 0.0871 ndcg@20: 0.1050 ] 
2025-04-17 07:44:53,773 - Epoch  57 Validation set [recall@5: 0.0747 recall@10: 0.1129 recall@20: 0.1669 ] [ndcg@5: 0.0748 ndcg@10: 0.0877 ndcg@20: 0.1054 ] 
2025-04-17 07:44:56,305 - [recall@5: 0.0742 recall@10: 0.1126 recall@20: 0.1685 ] [ndcg@5: 0.0731 ndcg@10: 0.0863 ndcg@20: 0.1044 ] 
2025-04-17 07:44:58,480 - [recall@5: 0.0735 recall@10: 0.1127 recall@20: 0.1671 ] [ndcg@5: 0.0727 ndcg@10: 0.0861 ndcg@20: 0.1038 ] 
2025-04-17 07:44:58,481 - Best Epoch 42. Final test result: {'recall': array([0.07345576, 0.1127121 , 0.16709393]), 'ndcg': array([0.07273898, 0.08611728, 0.10378827])}.
