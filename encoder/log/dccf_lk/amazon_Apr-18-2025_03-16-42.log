2025-04-18 03:16:42,232 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'dccf_lk', 'embedding_size': 64, 'intent_num': 128, 'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.15, 'amazon': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.15, 'proto_reg': '8e-8', 'num_clusters': 300, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}, 'yelp': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1, 'proto_reg': '8e-8', 'num_clusters': 300, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}, 'steam': {'layer_num': 3, 'reg_weight': 0.001, 'cl_weight': 0.001, 'temperature': 0.15, 'proto_reg': '8e-8', 'num_clusters': 300, 'm_step': 1, 'warm_up_step': 20, 'ssl_temp': 0.1, 'ssl_reg': '1e-7', 'embedding_size': 64}}}
2025-04-18 03:16:52,084 - Epoch   0 Validation set [recall@5: 0.0290 recall@10: 0.0498 recall@20: 0.0789 ] [ndcg@5: 0.0292 ndcg@10: 0.0368 ndcg@20: 0.0462 ] 
2025-04-18 03:16:58,606 - Epoch   3 Validation set [recall@5: 0.0522 recall@10: 0.0837 recall@20: 0.1253 ] [ndcg@5: 0.0519 ndcg@10: 0.0627 ndcg@20: 0.0764 ] 
2025-04-18 03:17:04,653 - Epoch   6 Validation set [recall@5: 0.0571 recall@10: 0.0922 recall@20: 0.1377 ] [ndcg@5: 0.0565 ndcg@10: 0.0688 ndcg@20: 0.0835 ] 
2025-04-18 03:17:10,993 - Epoch   9 Validation set [recall@5: 0.0608 recall@10: 0.0947 recall@20: 0.1408 ] [ndcg@5: 0.0594 ndcg@10: 0.0712 ndcg@20: 0.0861 ] 
2025-04-18 03:17:17,453 - Epoch  12 Validation set [recall@5: 0.0627 recall@10: 0.0967 recall@20: 0.1447 ] [ndcg@5: 0.0608 ndcg@10: 0.0727 ndcg@20: 0.0885 ] 
2025-04-18 03:17:23,850 - Epoch  15 Validation set [recall@5: 0.0629 recall@10: 0.0997 recall@20: 0.1504 ] [ndcg@5: 0.0620 ndcg@10: 0.0747 ndcg@20: 0.0913 ] 
2025-04-18 03:17:30,344 - Epoch  18 Validation set [recall@5: 0.0633 recall@10: 0.0992 recall@20: 0.1494 ] [ndcg@5: 0.0628 ndcg@10: 0.0750 ndcg@20: 0.0914 ] 
2025-04-18 03:17:36,457 - Epoch  21 Validation set [recall@5: 0.0642 recall@10: 0.1002 recall@20: 0.1522 ] [ndcg@5: 0.0633 ndcg@10: 0.0757 ndcg@20: 0.0927 ] 
2025-04-18 03:17:43,035 - Epoch  24 Validation set [recall@5: 0.0652 recall@10: 0.1004 recall@20: 0.1522 ] [ndcg@5: 0.0650 ndcg@10: 0.0767 ndcg@20: 0.0938 ] 
2025-04-18 03:17:49,443 - Epoch  27 Validation set [recall@5: 0.0654 recall@10: 0.1024 recall@20: 0.1535 ] [ndcg@5: 0.0646 ndcg@10: 0.0771 ndcg@20: 0.0939 ] 
2025-04-18 03:17:56,150 - Epoch  30 Validation set [recall@5: 0.0631 recall@10: 0.0999 recall@20: 0.1530 ] [ndcg@5: 0.0624 ndcg@10: 0.0754 ndcg@20: 0.0926 ] 
2025-04-18 03:18:02,524 - Epoch  33 Validation set [recall@5: 0.0642 recall@10: 0.1025 recall@20: 0.1550 ] [ndcg@5: 0.0639 ndcg@10: 0.0772 ndcg@20: 0.0942 ] 
2025-04-18 03:18:08,669 - Epoch  36 Validation set [recall@5: 0.0665 recall@10: 0.1031 recall@20: 0.1558 ] [ndcg@5: 0.0652 ndcg@10: 0.0780 ndcg@20: 0.0953 ] 
2025-04-18 03:18:15,106 - Epoch  39 Validation set [recall@5: 0.0674 recall@10: 0.1026 recall@20: 0.1555 ] [ndcg@5: 0.0663 ndcg@10: 0.0785 ndcg@20: 0.0956 ] 
2025-04-18 03:18:21,669 - Epoch  42 Validation set [recall@5: 0.0654 recall@10: 0.1028 recall@20: 0.1558 ] [ndcg@5: 0.0650 ndcg@10: 0.0781 ndcg@20: 0.0952 ] 
2025-04-18 03:18:28,084 - Epoch  45 Validation set [recall@5: 0.0672 recall@10: 0.1048 recall@20: 0.1569 ] [ndcg@5: 0.0661 ndcg@10: 0.0790 ndcg@20: 0.0959 ] 
2025-04-18 03:18:34,588 - Epoch  48 Validation set [recall@5: 0.0679 recall@10: 0.1048 recall@20: 0.1564 ] [ndcg@5: 0.0668 ndcg@10: 0.0797 ndcg@20: 0.0963 ] 
2025-04-18 03:18:41,464 - Epoch  51 Validation set [recall@5: 0.0656 recall@10: 0.1038 recall@20: 0.1548 ] [ndcg@5: 0.0665 ndcg@10: 0.0796 ndcg@20: 0.0962 ] 
2025-04-18 03:18:47,777 - Epoch  54 Validation set [recall@5: 0.0672 recall@10: 0.1037 recall@20: 0.1570 ] [ndcg@5: 0.0658 ndcg@10: 0.0786 ndcg@20: 0.0959 ] 
2025-04-18 03:18:54,370 - Epoch  57 Validation set [recall@5: 0.0681 recall@10: 0.1040 recall@20: 0.1556 ] [ndcg@5: 0.0676 ndcg@10: 0.0799 ndcg@20: 0.0970 ] 
2025-04-18 03:19:00,718 - Epoch  60 Validation set [recall@5: 0.0680 recall@10: 0.1048 recall@20: 0.1584 ] [ndcg@5: 0.0670 ndcg@10: 0.0797 ndcg@20: 0.0970 ] 
2025-04-18 03:19:06,966 - Epoch  63 Validation set [recall@5: 0.0666 recall@10: 0.1051 recall@20: 0.1575 ] [ndcg@5: 0.0661 ndcg@10: 0.0797 ndcg@20: 0.0967 ] 
2025-04-18 03:19:13,281 - Epoch  66 Validation set [recall@5: 0.0667 recall@10: 0.1035 recall@20: 0.1563 ] [ndcg@5: 0.0658 ndcg@10: 0.0784 ndcg@20: 0.0956 ] 
2025-04-18 03:19:19,648 - Epoch  69 Validation set [recall@5: 0.0669 recall@10: 0.1047 recall@20: 0.1558 ] [ndcg@5: 0.0666 ndcg@10: 0.0796 ndcg@20: 0.0963 ] 
2025-04-18 03:19:26,133 - Epoch  72 Validation set [recall@5: 0.0687 recall@10: 0.1057 recall@20: 0.1575 ] [ndcg@5: 0.0674 ndcg@10: 0.0801 ndcg@20: 0.0971 ] 
2025-04-18 03:19:32,696 - Epoch  75 Validation set [recall@5: 0.0665 recall@10: 0.1043 recall@20: 0.1581 ] [ndcg@5: 0.0660 ndcg@10: 0.0791 ndcg@20: 0.0966 ] 
2025-04-18 03:19:34,556 - [recall@5: 0.0680 recall@10: 0.1048 recall@20: 0.1584 ] [ndcg@5: 0.0670 ndcg@10: 0.0797 ndcg@20: 0.0970 ] 
2025-04-18 03:19:36,527 - [recall@5: 0.0648 recall@10: 0.1056 recall@20: 0.1570 ] [ndcg@5: 0.0646 ndcg@10: 0.0790 ndcg@20: 0.0958 ] 
2025-04-18 03:19:36,528 - Best Epoch 60. Final test result: {'recall': array([0.06476089, 0.10561011, 0.15703071]), 'ndcg': array([0.06458914, 0.07896138, 0.09581682])}.
去掉cl损失