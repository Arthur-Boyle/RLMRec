2025-04-09 01:55:28,059 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'dccf', 'embedding_size': 32, 'intent_num': 128, 'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1, 'amazon': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1}, 'yelp': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1}, 'steam': {'layer_num': 3, 'reg_weight': 0.001, 'cl_weight': 0.001, 'temperature': 0.1}}}
2025-04-09 01:55:33,190 - Epoch   0 Validation set [recall@5: 0.0129 recall@10: 0.0221 recall@20: 0.0398 ] [ndcg@5: 0.0127 ndcg@10: 0.0161 ndcg@20: 0.0220 ] 
2025-04-09 01:55:40,929 - Epoch   3 Validation set [recall@5: 0.0401 recall@10: 0.0646 recall@20: 0.1020 ] [ndcg@5: 0.0398 ndcg@10: 0.0484 ndcg@20: 0.0605 ] 
2025-04-09 01:55:48,884 - Epoch   6 Validation set [recall@5: 0.0456 recall@10: 0.0747 recall@20: 0.1158 ] [ndcg@5: 0.0457 ndcg@10: 0.0557 ndcg@20: 0.0691 ] 
2025-04-09 01:55:56,717 - Epoch   9 Validation set [recall@5: 0.0495 recall@10: 0.0785 recall@20: 0.1223 ] [ndcg@5: 0.0499 ndcg@10: 0.0596 ndcg@20: 0.0737 ] 
2025-04-09 01:56:04,724 - Epoch  12 Validation set [recall@5: 0.0505 recall@10: 0.0806 recall@20: 0.1249 ] [ndcg@5: 0.0506 ndcg@10: 0.0607 ndcg@20: 0.0751 ] 
2025-04-09 01:56:12,574 - Epoch  15 Validation set [recall@5: 0.0515 recall@10: 0.0835 recall@20: 0.1268 ] [ndcg@5: 0.0518 ndcg@10: 0.0629 ndcg@20: 0.0771 ] 
2025-04-09 01:56:20,788 - Epoch  18 Validation set [recall@5: 0.0526 recall@10: 0.0850 recall@20: 0.1308 ] [ndcg@5: 0.0521 ndcg@10: 0.0633 ndcg@20: 0.0783 ] 
2025-04-09 01:56:28,182 - Epoch  21 Validation set [recall@5: 0.0535 recall@10: 0.0870 recall@20: 0.1322 ] [ndcg@5: 0.0524 ndcg@10: 0.0641 ndcg@20: 0.0788 ] 
2025-04-09 01:56:35,732 - Epoch  24 Validation set [recall@5: 0.0541 recall@10: 0.0883 recall@20: 0.1334 ] [ndcg@5: 0.0538 ndcg@10: 0.0655 ndcg@20: 0.0803 ] 
2025-04-09 01:56:43,450 - Epoch  27 Validation set [recall@5: 0.0544 recall@10: 0.0870 recall@20: 0.1359 ] [ndcg@5: 0.0536 ndcg@10: 0.0650 ndcg@20: 0.0809 ] 
2025-04-09 01:56:51,126 - Epoch  30 Validation set [recall@5: 0.0533 recall@10: 0.0876 recall@20: 0.1336 ] [ndcg@5: 0.0535 ndcg@10: 0.0654 ndcg@20: 0.0805 ] 
2025-04-09 01:56:59,013 - Epoch  33 Validation set [recall@5: 0.0563 recall@10: 0.0879 recall@20: 0.1346 ] [ndcg@5: 0.0548 ndcg@10: 0.0657 ndcg@20: 0.0810 ] 
2025-04-09 01:57:06,785 - Epoch  36 Validation set [recall@5: 0.0555 recall@10: 0.0899 recall@20: 0.1366 ] [ndcg@5: 0.0555 ndcg@10: 0.0673 ndcg@20: 0.0826 ] 
2025-04-09 01:57:14,501 - Epoch  39 Validation set [recall@5: 0.0567 recall@10: 0.0904 recall@20: 0.1362 ] [ndcg@5: 0.0560 ndcg@10: 0.0679 ndcg@20: 0.0827 ] 
2025-04-09 01:57:21,857 - Epoch  42 Validation set [recall@5: 0.0567 recall@10: 0.0911 recall@20: 0.1405 ] [ndcg@5: 0.0559 ndcg@10: 0.0677 ndcg@20: 0.0837 ] 
2025-04-09 01:57:29,388 - Epoch  45 Validation set [recall@5: 0.0572 recall@10: 0.0918 recall@20: 0.1404 ] [ndcg@5: 0.0571 ndcg@10: 0.0688 ndcg@20: 0.0844 ] 
2025-04-09 01:57:36,558 - Epoch  48 Validation set [recall@5: 0.0583 recall@10: 0.0921 recall@20: 0.1391 ] [ndcg@5: 0.0575 ndcg@10: 0.0690 ndcg@20: 0.0843 ] 
2025-04-09 01:57:43,754 - Epoch  51 Validation set [recall@5: 0.0558 recall@10: 0.0899 recall@20: 0.1390 ] [ndcg@5: 0.0561 ndcg@10: 0.0677 ndcg@20: 0.0838 ] 
2025-04-09 01:57:51,255 - Epoch  54 Validation set [recall@5: 0.0565 recall@10: 0.0898 recall@20: 0.1406 ] [ndcg@5: 0.0567 ndcg@10: 0.0681 ndcg@20: 0.0846 ] 
2025-04-09 01:57:58,480 - Epoch  57 Validation set [recall@5: 0.0586 recall@10: 0.0932 recall@20: 0.1402 ] [ndcg@5: 0.0579 ndcg@10: 0.0697 ndcg@20: 0.0850 ] 
2025-04-09 01:58:05,683 - Epoch  60 Validation set [recall@5: 0.0585 recall@10: 0.0932 recall@20: 0.1398 ] [ndcg@5: 0.0581 ndcg@10: 0.0700 ndcg@20: 0.0852 ] 
2025-04-09 01:58:13,053 - Epoch  63 Validation set [recall@5: 0.0571 recall@10: 0.0923 recall@20: 0.1422 ] [ndcg@5: 0.0567 ndcg@10: 0.0691 ndcg@20: 0.0854 ] 
2025-04-09 01:58:20,085 - Epoch  66 Validation set [recall@5: 0.0585 recall@10: 0.0931 recall@20: 0.1417 ] [ndcg@5: 0.0575 ndcg@10: 0.0695 ndcg@20: 0.0855 ] 
2025-04-09 01:58:27,331 - Epoch  69 Validation set [recall@5: 0.0575 recall@10: 0.0938 recall@20: 0.1396 ] [ndcg@5: 0.0570 ndcg@10: 0.0694 ndcg@20: 0.0844 ] 
2025-04-09 01:58:34,815 - Epoch  72 Validation set [recall@5: 0.0599 recall@10: 0.0941 recall@20: 0.1413 ] [ndcg@5: 0.0584 ndcg@10: 0.0700 ndcg@20: 0.0854 ] 
2025-04-09 01:58:42,299 - Epoch  75 Validation set [recall@5: 0.0591 recall@10: 0.0922 recall@20: 0.1420 ] [ndcg@5: 0.0585 ndcg@10: 0.0698 ndcg@20: 0.0859 ] 
2025-04-09 01:58:49,676 - Epoch  78 Validation set [recall@5: 0.0583 recall@10: 0.0925 recall@20: 0.1421 ] [ndcg@5: 0.0578 ndcg@10: 0.0694 ndcg@20: 0.0854 ] 
2025-04-09 01:58:51,723 - [recall@5: 0.0571 recall@10: 0.0923 recall@20: 0.1422 ] [ndcg@5: 0.0567 ndcg@10: 0.0691 ndcg@20: 0.0854 ] 
2025-04-09 01:58:53,820 - [recall@5: 0.0566 recall@10: 0.0918 recall@20: 0.1400 ] [ndcg@5: 0.0575 ndcg@10: 0.0698 ndcg@20: 0.0855 ] 
2025-04-09 01:58:53,821 - Best Epoch 63. Final test result: {'recall': array([0.05663797, 0.09181684, 0.13996659]), 'ndcg': array([0.05747679, 0.06980946, 0.08548805])}.
加了attention1聚合 变差了