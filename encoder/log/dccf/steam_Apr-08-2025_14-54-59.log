2025-04-08 14:54:59,965 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'steam', 'user_num': 23310, 'item_num': 5237}, 'model': {'name': 'dccf', 'embedding_size': 32, 'intent_num': 128, 'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1, 'amazon': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1}, 'yelp': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1}, 'steam': {'layer_num': 3, 'reg_weight': 0.001, 'cl_weight': 0.001, 'temperature': 0.1}}}
2025-04-08 14:55:14,375 - Epoch   0 Validation set [recall@5: 0.0400 recall@10: 0.0652 recall@20: 0.1077 ] [ndcg@5: 0.0455 ndcg@10: 0.0533 ndcg@20: 0.0674 ] 
2025-04-08 14:55:45,106 - Epoch   3 Validation set [recall@5: 0.0490 recall@10: 0.0811 recall@20: 0.1286 ] [ndcg@5: 0.0548 ndcg@10: 0.0651 ndcg@20: 0.0811 ] 
2025-04-08 14:56:15,021 - Epoch   6 Validation set [recall@5: 0.0506 recall@10: 0.0840 recall@20: 0.1337 ] [ndcg@5: 0.0569 ndcg@10: 0.0678 ndcg@20: 0.0845 ] 
2025-04-08 14:56:45,199 - Epoch   9 Validation set [recall@5: 0.0512 recall@10: 0.0852 recall@20: 0.1336 ] [ndcg@5: 0.0571 ndcg@10: 0.0683 ndcg@20: 0.0846 ] 
2025-04-08 14:57:15,421 - Epoch  12 Validation set [recall@5: 0.0526 recall@10: 0.0861 recall@20: 0.1353 ] [ndcg@5: 0.0586 ndcg@10: 0.0696 ndcg@20: 0.0861 ] 
2025-04-08 14:57:46,386 - Epoch  15 Validation set [recall@5: 0.0519 recall@10: 0.0853 recall@20: 0.1355 ] [ndcg@5: 0.0575 ndcg@10: 0.0684 ndcg@20: 0.0853 ] 
2025-04-08 14:58:28,095 - Epoch  18 Validation set [recall@5: 0.0525 recall@10: 0.0861 recall@20: 0.1372 ] [ndcg@5: 0.0587 ndcg@10: 0.0697 ndcg@20: 0.0869 ] 
2025-04-08 14:58:59,160 - Epoch  21 Validation set [recall@5: 0.0525 recall@10: 0.0856 recall@20: 0.1367 ] [ndcg@5: 0.0587 ndcg@10: 0.0694 ndcg@20: 0.0865 ] 
2025-04-08 14:59:29,682 - Epoch  24 Validation set [recall@5: 0.0513 recall@10: 0.0856 recall@20: 0.1362 ] [ndcg@5: 0.0573 ndcg@10: 0.0688 ndcg@20: 0.0860 ] 
2025-04-08 15:00:00,601 - Epoch  27 Validation set [recall@5: 0.0520 recall@10: 0.0865 recall@20: 0.1360 ] [ndcg@5: 0.0575 ndcg@10: 0.0691 ndcg@20: 0.0858 ] 
2025-04-08 15:00:31,191 - Epoch  30 Validation set [recall@5: 0.0532 recall@10: 0.0876 recall@20: 0.1376 ] [ndcg@5: 0.0590 ndcg@10: 0.0702 ndcg@20: 0.0872 ] 
2025-04-08 15:01:01,865 - Epoch  33 Validation set [recall@5: 0.0530 recall@10: 0.0859 recall@20: 0.1379 ] [ndcg@5: 0.0593 ndcg@10: 0.0699 ndcg@20: 0.0875 ] 
2025-04-08 15:01:32,973 - Epoch  36 Validation set [recall@5: 0.0527 recall@10: 0.0867 recall@20: 0.1368 ] [ndcg@5: 0.0586 ndcg@10: 0.0696 ndcg@20: 0.0864 ] 
2025-04-08 15:02:03,373 - Epoch  39 Validation set [recall@5: 0.0527 recall@10: 0.0870 recall@20: 0.1376 ] [ndcg@5: 0.0588 ndcg@10: 0.0698 ndcg@20: 0.0869 ] 
2025-04-08 15:02:34,075 - Epoch  42 Validation set [recall@5: 0.0531 recall@10: 0.0862 recall@20: 0.1376 ] [ndcg@5: 0.0588 ndcg@10: 0.0696 ndcg@20: 0.0869 ] 
2025-04-08 15:03:04,410 - Epoch  45 Validation set [recall@5: 0.0531 recall@10: 0.0881 recall@20: 0.1386 ] [ndcg@5: 0.0591 ndcg@10: 0.0706 ndcg@20: 0.0876 ] 
2025-04-08 15:03:35,074 - Epoch  48 Validation set [recall@5: 0.0539 recall@10: 0.0874 recall@20: 0.1383 ] [ndcg@5: 0.0599 ndcg@10: 0.0707 ndcg@20: 0.0878 ] 
2025-04-08 15:04:06,782 - Epoch  51 Validation set [recall@5: 0.0533 recall@10: 0.0866 recall@20: 0.1371 ] [ndcg@5: 0.0594 ndcg@10: 0.0701 ndcg@20: 0.0870 ] 
2025-04-08 15:04:37,631 - Epoch  54 Validation set [recall@5: 0.0528 recall@10: 0.0877 recall@20: 0.1380 ] [ndcg@5: 0.0588 ndcg@10: 0.0703 ndcg@20: 0.0873 ] 
2025-04-08 15:05:08,225 - Epoch  57 Validation set [recall@5: 0.0537 recall@10: 0.0870 recall@20: 0.1388 ] [ndcg@5: 0.0596 ndcg@10: 0.0704 ndcg@20: 0.0878 ] 
2025-04-08 15:05:38,969 - Epoch  60 Validation set [recall@5: 0.0535 recall@10: 0.0873 recall@20: 0.1382 ] [ndcg@5: 0.0596 ndcg@10: 0.0709 ndcg@20: 0.0881 ] 
2025-04-08 15:06:09,712 - Epoch  63 Validation set [recall@5: 0.0529 recall@10: 0.0873 recall@20: 0.1386 ] [ndcg@5: 0.0593 ndcg@10: 0.0705 ndcg@20: 0.0877 ] 
2025-04-08 15:06:41,074 - Epoch  66 Validation set [recall@5: 0.0529 recall@10: 0.0871 recall@20: 0.1377 ] [ndcg@5: 0.0591 ndcg@10: 0.0703 ndcg@20: 0.0874 ] 
2025-04-08 15:07:12,561 - Epoch  69 Validation set [recall@5: 0.0537 recall@10: 0.0876 recall@20: 0.1384 ] [ndcg@5: 0.0602 ndcg@10: 0.0712 ndcg@20: 0.0883 ] 
2025-04-08 15:07:43,646 - Epoch  72 Validation set [recall@5: 0.0537 recall@10: 0.0883 recall@20: 0.1388 ] [ndcg@5: 0.0602 ndcg@10: 0.0714 ndcg@20: 0.0882 ] 
2025-04-08 15:07:47,722 - [recall@5: 0.0537 recall@10: 0.0870 recall@20: 0.1388 ] [ndcg@5: 0.0596 ndcg@10: 0.0704 ndcg@20: 0.0878 ] 
2025-04-08 15:07:51,364 - [recall@5: 0.0530 recall@10: 0.0865 recall@20: 0.1370 ] [ndcg@5: 0.0582 ndcg@10: 0.0695 ndcg@20: 0.0866 ] 
2025-04-08 15:07:51,364 - Best Epoch 57. Final test result: {'recall': array([0.05295401, 0.08652444, 0.1369933 ]), 'ndcg': array([0.0581896 , 0.06952967, 0.0865904 ])}.
#加了attention聚合