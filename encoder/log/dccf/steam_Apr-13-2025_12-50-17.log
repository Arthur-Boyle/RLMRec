2025-04-13 12:50:17,040 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'steam', 'user_num': 23310, 'item_num': 5237}, 'model': {'name': 'dccf', 'embedding_size': 64, 'intent_num': 128, 'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.15, 'amazon': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.15}, 'yelp': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1}, 'steam': {'layer_num': 3, 'reg_weight': 0.001, 'cl_weight': 0.001, 'temperature': 0.15}}}
2025-04-13 12:51:01,199 - Epoch   0 Validation set [recall@5: 0.0512 recall@10: 0.0822 recall@20: 0.1299 ] [ndcg@5: 0.0572 ndcg@10: 0.0670 ndcg@20: 0.0831 ] 
2025-04-13 12:52:48,367 - Epoch   3 Validation set [recall@5: 0.0549 recall@10: 0.0886 recall@20: 0.1418 ] [ndcg@5: 0.0608 ndcg@10: 0.0718 ndcg@20: 0.0897 ] 
2025-04-13 12:54:36,933 - Epoch   6 Validation set [recall@5: 0.0570 recall@10: 0.0924 recall@20: 0.1431 ] [ndcg@5: 0.0631 ndcg@10: 0.0746 ndcg@20: 0.0918 ] 
2025-04-13 12:56:26,306 - Epoch   9 Validation set [recall@5: 0.0565 recall@10: 0.0915 recall@20: 0.1409 ] [ndcg@5: 0.0613 ndcg@10: 0.0728 ndcg@20: 0.0895 ] 
2025-04-13 12:58:14,742 - Epoch  12 Validation set [recall@5: 0.0571 recall@10: 0.0936 recall@20: 0.1447 ] [ndcg@5: 0.0627 ndcg@10: 0.0749 ndcg@20: 0.0922 ] 
2025-04-13 13:00:03,521 - Epoch  15 Validation set [recall@5: 0.0573 recall@10: 0.0935 recall@20: 0.1453 ] [ndcg@5: 0.0629 ndcg@10: 0.0747 ndcg@20: 0.0922 ] 
2025-04-13 13:01:52,170 - Epoch  18 Validation set [recall@5: 0.0566 recall@10: 0.0922 recall@20: 0.1454 ] [ndcg@5: 0.0623 ndcg@10: 0.0743 ndcg@20: 0.0923 ] 
2025-04-13 13:03:41,087 - Epoch  21 Validation set [recall@5: 0.0562 recall@10: 0.0919 recall@20: 0.1441 ] [ndcg@5: 0.0618 ndcg@10: 0.0736 ndcg@20: 0.0914 ] 
2025-04-13 13:05:28,802 - Epoch  24 Validation set [recall@5: 0.0545 recall@10: 0.0889 recall@20: 0.1407 ] [ndcg@5: 0.0596 ndcg@10: 0.0710 ndcg@20: 0.0889 ] 
2025-04-13 13:07:17,419 - Epoch  27 Validation set [recall@5: 0.0548 recall@10: 0.0883 recall@20: 0.1389 ] [ndcg@5: 0.0596 ndcg@10: 0.0708 ndcg@20: 0.0881 ] 
2025-04-13 13:09:04,928 - Epoch  30 Validation set [recall@5: 0.0572 recall@10: 0.0918 recall@20: 0.1443 ] [ndcg@5: 0.0625 ndcg@10: 0.0739 ndcg@20: 0.0918 ] 
2025-04-13 13:10:54,244 - Epoch  33 Validation set [recall@5: 0.0563 recall@10: 0.0909 recall@20: 0.1429 ] [ndcg@5: 0.0609 ndcg@10: 0.0725 ndcg@20: 0.0902 ] 
2025-04-13 13:10:58,047 - [recall@5: 0.0566 recall@10: 0.0922 recall@20: 0.1454 ] [ndcg@5: 0.0623 ndcg@10: 0.0743 ndcg@20: 0.0923 ] 
2025-04-13 13:11:01,963 - [recall@5: 0.0570 recall@10: 0.0912 recall@20: 0.1436 ] [ndcg@5: 0.0631 ndcg@10: 0.0743 ndcg@20: 0.0921 ] 
2025-04-13 13:11:01,964 - Best Epoch 18. Final test result: {'recall': array([0.05704959, 0.0911991 , 0.14356541]), 'ndcg': array([0.06309013, 0.07432826, 0.09211581])}.
改了温度0.15变好了