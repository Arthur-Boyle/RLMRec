2025-04-09 02:50:00,450 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'dccf', 'embedding_size': 32, 'intent_num': 128, 'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1, 'amazon': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1}, 'yelp': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1}, 'steam': {'layer_num': 3, 'reg_weight': 0.001, 'cl_weight': 0.001, 'temperature': 0.1}}}
2025-04-09 02:50:05,745 - Epoch   0 Validation set [recall@5: 0.0103 recall@10: 0.0177 recall@20: 0.0332 ] [ndcg@5: 0.0096 ndcg@10: 0.0123 ndcg@20: 0.0174 ] 
2025-04-09 02:50:14,086 - Epoch   3 Validation set [recall@5: 0.0343 recall@10: 0.0559 recall@20: 0.0901 ] [ndcg@5: 0.0333 ndcg@10: 0.0410 ndcg@20: 0.0522 ] 
2025-04-09 02:50:21,978 - Epoch   6 Validation set [recall@5: 0.0377 recall@10: 0.0614 recall@20: 0.0987 ] [ndcg@5: 0.0379 ndcg@10: 0.0461 ndcg@20: 0.0585 ] 
2025-04-09 02:50:29,950 - Epoch   9 Validation set [recall@5: 0.0430 recall@10: 0.0682 recall@20: 0.1058 ] [ndcg@5: 0.0425 ndcg@10: 0.0512 ndcg@20: 0.0634 ] 
2025-04-09 02:50:37,918 - Epoch  12 Validation set [recall@5: 0.0444 recall@10: 0.0701 recall@20: 0.1080 ] [ndcg@5: 0.0441 ndcg@10: 0.0531 ndcg@20: 0.0655 ] 
2025-04-09 02:50:45,769 - Epoch  15 Validation set [recall@5: 0.0452 recall@10: 0.0707 recall@20: 0.1099 ] [ndcg@5: 0.0448 ndcg@10: 0.0536 ndcg@20: 0.0663 ] 
2025-04-09 02:50:53,454 - Epoch  18 Validation set [recall@5: 0.0439 recall@10: 0.0702 recall@20: 0.1122 ] [ndcg@5: 0.0440 ndcg@10: 0.0529 ndcg@20: 0.0666 ] 
2025-04-09 02:51:00,482 - Epoch  21 Validation set [recall@5: 0.0475 recall@10: 0.0735 recall@20: 0.1149 ] [ndcg@5: 0.0465 ndcg@10: 0.0554 ndcg@20: 0.0688 ] 
2025-04-09 02:51:07,763 - Epoch  24 Validation set [recall@5: 0.0471 recall@10: 0.0751 recall@20: 0.1167 ] [ndcg@5: 0.0475 ndcg@10: 0.0569 ndcg@20: 0.0705 ] 
2025-04-09 02:51:15,300 - Epoch  27 Validation set [recall@5: 0.0488 recall@10: 0.0746 recall@20: 0.1159 ] [ndcg@5: 0.0483 ndcg@10: 0.0569 ndcg@20: 0.0704 ] 
2025-04-09 02:51:22,661 - Epoch  30 Validation set [recall@5: 0.0476 recall@10: 0.0757 recall@20: 0.1142 ] [ndcg@5: 0.0475 ndcg@10: 0.0570 ndcg@20: 0.0697 ] 
2025-04-09 02:51:30,200 - Epoch  33 Validation set [recall@5: 0.0480 recall@10: 0.0775 recall@20: 0.1153 ] [ndcg@5: 0.0476 ndcg@10: 0.0579 ndcg@20: 0.0703 ] 
2025-04-09 02:51:37,633 - Epoch  36 Validation set [recall@5: 0.0486 recall@10: 0.0764 recall@20: 0.1167 ] [ndcg@5: 0.0476 ndcg@10: 0.0569 ndcg@20: 0.0701 ] 
2025-04-09 02:51:44,792 - Epoch  39 Validation set [recall@5: 0.0502 recall@10: 0.0767 recall@20: 0.1194 ] [ndcg@5: 0.0494 ndcg@10: 0.0581 ndcg@20: 0.0719 ] 
2025-04-09 02:51:51,928 - Epoch  42 Validation set [recall@5: 0.0486 recall@10: 0.0784 recall@20: 0.1205 ] [ndcg@5: 0.0484 ndcg@10: 0.0585 ndcg@20: 0.0724 ] 
2025-04-09 02:51:59,322 - Epoch  45 Validation set [recall@5: 0.0499 recall@10: 0.0770 recall@20: 0.1199 ] [ndcg@5: 0.0496 ndcg@10: 0.0585 ndcg@20: 0.0725 ] 
2025-04-09 02:52:06,763 - Epoch  48 Validation set [recall@5: 0.0513 recall@10: 0.0789 recall@20: 0.1199 ] [ndcg@5: 0.0517 ndcg@10: 0.0608 ndcg@20: 0.0740 ] 
2025-04-09 02:52:14,185 - Epoch  51 Validation set [recall@5: 0.0501 recall@10: 0.0777 recall@20: 0.1192 ] [ndcg@5: 0.0504 ndcg@10: 0.0595 ndcg@20: 0.0729 ] 
2025-04-09 02:52:21,439 - Epoch  54 Validation set [recall@5: 0.0497 recall@10: 0.0771 recall@20: 0.1184 ] [ndcg@5: 0.0492 ndcg@10: 0.0583 ndcg@20: 0.0717 ] 
2025-04-09 02:52:28,754 - Epoch  57 Validation set [recall@5: 0.0492 recall@10: 0.0789 recall@20: 0.1207 ] [ndcg@5: 0.0494 ndcg@10: 0.0594 ndcg@20: 0.0730 ] 
2025-04-09 02:52:35,829 - Epoch  60 Validation set [recall@5: 0.0490 recall@10: 0.0786 recall@20: 0.1190 ] [ndcg@5: 0.0494 ndcg@10: 0.0594 ndcg@20: 0.0725 ] 
2025-04-09 02:52:42,912 - Epoch  63 Validation set [recall@5: 0.0498 recall@10: 0.0798 recall@20: 0.1206 ] [ndcg@5: 0.0490 ndcg@10: 0.0593 ndcg@20: 0.0726 ] 
2025-04-09 02:52:50,264 - Epoch  66 Validation set [recall@5: 0.0488 recall@10: 0.0769 recall@20: 0.1175 ] [ndcg@5: 0.0473 ndcg@10: 0.0568 ndcg@20: 0.0701 ] 
2025-04-09 02:52:57,511 - Epoch  69 Validation set [recall@5: 0.0481 recall@10: 0.0750 recall@20: 0.1175 ] [ndcg@5: 0.0478 ndcg@10: 0.0567 ndcg@20: 0.0706 ] 
2025-04-09 02:53:04,862 - Epoch  72 Validation set [recall@5: 0.0491 recall@10: 0.0772 recall@20: 0.1164 ] [ndcg@5: 0.0479 ndcg@10: 0.0577 ndcg@20: 0.0706 ] 
2025-04-09 02:53:06,881 - [recall@5: 0.0492 recall@10: 0.0789 recall@20: 0.1207 ] [ndcg@5: 0.0494 ndcg@10: 0.0594 ndcg@20: 0.0730 ] 
2025-04-09 02:53:09,195 - [recall@5: 0.0455 recall@10: 0.0753 recall@20: 0.1147 ] [ndcg@5: 0.0454 ndcg@10: 0.0559 ndcg@20: 0.0688 ] 
2025-04-09 02:53:09,196 - Best Epoch 57. Final test result: {'recall': array([0.04554986, 0.07534441, 0.11467225]), 'ndcg': array([0.04538477, 0.05587447, 0.06884225])}.
加了attention2聚合