2025-04-08 09:48:50,883 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'dccf', 'embedding_size': 32, 'intent_num': 128, 'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1, 'amazon': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1}, 'yelp': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'temperature': 0.1}, 'steam': {'layer_num': 3, 'reg_weight': 0.001, 'cl_weight': 0.001, 'temperature': 0.1}}}
2025-04-08 09:48:55,501 - Epoch   0 Validation set [recall@5: 0.0296 recall@10: 0.0483 recall@20: 0.0739 ] [ndcg@5: 0.0307 ndcg@10: 0.0371 ndcg@20: 0.0456 ] 
2025-04-08 09:49:02,320 - Epoch   3 Validation set [recall@5: 0.0525 recall@10: 0.0851 recall@20: 0.1277 ] [ndcg@5: 0.0527 ndcg@10: 0.0640 ndcg@20: 0.0780 ] 
2025-04-08 09:49:08,638 - Epoch   6 Validation set [recall@5: 0.0591 recall@10: 0.0927 recall@20: 0.1383 ] [ndcg@5: 0.0587 ndcg@10: 0.0705 ndcg@20: 0.0854 ] 
2025-04-08 09:49:15,441 - Epoch   9 Validation set [recall@5: 0.0628 recall@10: 0.0960 recall@20: 0.1431 ] [ndcg@5: 0.0629 ndcg@10: 0.0741 ndcg@20: 0.0895 ] 
2025-04-08 09:49:22,231 - Epoch  12 Validation set [recall@5: 0.0643 recall@10: 0.1005 recall@20: 0.1469 ] [ndcg@5: 0.0641 ndcg@10: 0.0768 ndcg@20: 0.0921 ] 
2025-04-08 09:49:28,897 - Epoch  15 Validation set [recall@5: 0.0666 recall@10: 0.1008 recall@20: 0.1473 ] [ndcg@5: 0.0664 ndcg@10: 0.0780 ndcg@20: 0.0932 ] 
2025-04-08 09:49:35,658 - Epoch  18 Validation set [recall@5: 0.0673 recall@10: 0.1022 recall@20: 0.1508 ] [ndcg@5: 0.0666 ndcg@10: 0.0786 ndcg@20: 0.0945 ] 
2025-04-08 09:49:42,260 - Epoch  21 Validation set [recall@5: 0.0680 recall@10: 0.1028 recall@20: 0.1531 ] [ndcg@5: 0.0672 ndcg@10: 0.0791 ndcg@20: 0.0955 ] 
2025-04-08 09:49:48,699 - Epoch  24 Validation set [recall@5: 0.0681 recall@10: 0.1035 recall@20: 0.1522 ] [ndcg@5: 0.0679 ndcg@10: 0.0801 ndcg@20: 0.0961 ] 
2025-04-08 09:49:54,950 - Epoch  27 Validation set [recall@5: 0.0686 recall@10: 0.1029 recall@20: 0.1545 ] [ndcg@5: 0.0681 ndcg@10: 0.0798 ndcg@20: 0.0965 ] 
2025-04-08 09:50:01,029 - Epoch  30 Validation set [recall@5: 0.0689 recall@10: 0.1030 recall@20: 0.1524 ] [ndcg@5: 0.0682 ndcg@10: 0.0796 ndcg@20: 0.0958 ] 
2025-04-08 09:50:07,128 - Epoch  33 Validation set [recall@5: 0.0702 recall@10: 0.1049 recall@20: 0.1527 ] [ndcg@5: 0.0691 ndcg@10: 0.0809 ndcg@20: 0.0966 ] 
2025-04-08 09:50:13,271 - Epoch  36 Validation set [recall@5: 0.0695 recall@10: 0.1047 recall@20: 0.1521 ] [ndcg@5: 0.0690 ndcg@10: 0.0807 ndcg@20: 0.0963 ] 
2025-04-08 09:50:19,494 - Epoch  39 Validation set [recall@5: 0.0699 recall@10: 0.1046 recall@20: 0.1554 ] [ndcg@5: 0.0700 ndcg@10: 0.0816 ndcg@20: 0.0982 ] 
2025-04-08 09:50:26,004 - Epoch  42 Validation set [recall@5: 0.0692 recall@10: 0.1051 recall@20: 0.1540 ] [ndcg@5: 0.0680 ndcg@10: 0.0804 ndcg@20: 0.0965 ] 
2025-04-08 09:50:32,163 - Epoch  45 Validation set [recall@5: 0.0684 recall@10: 0.1047 recall@20: 0.1543 ] [ndcg@5: 0.0682 ndcg@10: 0.0806 ndcg@20: 0.0970 ] 
2025-04-08 09:50:38,486 - Epoch  48 Validation set [recall@5: 0.0686 recall@10: 0.1055 recall@20: 0.1551 ] [ndcg@5: 0.0684 ndcg@10: 0.0812 ndcg@20: 0.0974 ] 
2025-04-08 09:50:44,833 - Epoch  51 Validation set [recall@5: 0.0685 recall@10: 0.1039 recall@20: 0.1529 ] [ndcg@5: 0.0677 ndcg@10: 0.0798 ndcg@20: 0.0959 ] 
2025-04-08 09:50:51,319 - Epoch  54 Validation set [recall@5: 0.0690 recall@10: 0.1058 recall@20: 0.1548 ] [ndcg@5: 0.0670 ndcg@10: 0.0801 ndcg@20: 0.0961 ] 
2025-04-08 09:50:53,417 - [recall@5: 0.0699 recall@10: 0.1046 recall@20: 0.1554 ] [ndcg@5: 0.0700 ndcg@10: 0.0816 ndcg@20: 0.0982 ] 
2025-04-08 09:50:55,423 - [recall@5: 0.0669 recall@10: 0.1044 recall@20: 0.1517 ] [ndcg@5: 0.0661 ndcg@10: 0.0791 ndcg@20: 0.0945 ] 
2025-04-08 09:50:55,424 - Best Epoch 39. Final test result: {'recall': array([0.06691283, 0.10435659, 0.15173422]), 'ndcg': array([0.06613671, 0.07905386, 0.09450452])}.
原来的dccf