2025-04-14 09:38:55,037 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'xsimgcl', 'keep_rate': 1.0, 'embedding_size': 64, 'layer_num': 3, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.15, 'eps': 0.9, 'amazon': {'layer_num': 3, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.15, 'eps': 0.2}, 'yelp': {'layer_num': 3, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.2, 'eps': 0.9}, 'steam': {'layer_num': 3, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.5, 'eps': 0.2}}}
2025-04-14 09:38:58,919 - Epoch   0 Validation set [recall@5: 0.0446 recall@10: 0.0679 recall@20: 0.0969 ] [ndcg@5: 0.0440 ndcg@10: 0.0519 ndcg@20: 0.0614 ] 
2025-04-14 09:39:03,778 - Epoch   3 Validation set [recall@5: 0.0564 recall@10: 0.0834 recall@20: 0.1174 ] [ndcg@5: 0.0572 ndcg@10: 0.0661 ndcg@20: 0.0770 ] 
2025-04-14 09:39:08,534 - Epoch   6 Validation set [recall@5: 0.0621 recall@10: 0.0910 recall@20: 0.1256 ] [ndcg@5: 0.0635 ndcg@10: 0.0727 ndcg@20: 0.0838 ] 
2025-04-14 09:39:13,422 - Epoch   9 Validation set [recall@5: 0.0659 recall@10: 0.0947 recall@20: 0.1299 ] [ndcg@5: 0.0671 ndcg@10: 0.0760 ndcg@20: 0.0874 ] 
2025-04-14 09:39:18,090 - Epoch  12 Validation set [recall@5: 0.0671 recall@10: 0.0969 recall@20: 0.1327 ] [ndcg@5: 0.0683 ndcg@10: 0.0777 ndcg@20: 0.0893 ] 
2025-04-14 09:39:22,710 - Epoch  15 Validation set [recall@5: 0.0689 recall@10: 0.0980 recall@20: 0.1353 ] [ndcg@5: 0.0694 ndcg@10: 0.0785 ndcg@20: 0.0906 ] 
2025-04-14 09:39:27,141 - Epoch  18 Validation set [recall@5: 0.0688 recall@10: 0.0988 recall@20: 0.1366 ] [ndcg@5: 0.0698 ndcg@10: 0.0793 ndcg@20: 0.0915 ] 
2025-04-14 09:39:31,765 - Epoch  21 Validation set [recall@5: 0.0693 recall@10: 0.0993 recall@20: 0.1383 ] [ndcg@5: 0.0699 ndcg@10: 0.0794 ndcg@20: 0.0918 ] 
2025-04-14 09:39:36,340 - Epoch  24 Validation set [recall@5: 0.0701 recall@10: 0.0988 recall@20: 0.1385 ] [ndcg@5: 0.0706 ndcg@10: 0.0796 ndcg@20: 0.0924 ] 
2025-04-14 09:39:41,007 - Epoch  27 Validation set [recall@5: 0.0706 recall@10: 0.0993 recall@20: 0.1386 ] [ndcg@5: 0.0710 ndcg@10: 0.0800 ndcg@20: 0.0926 ] 
2025-04-14 09:39:45,524 - Epoch  30 Validation set [recall@5: 0.0703 recall@10: 0.0989 recall@20: 0.1398 ] [ndcg@5: 0.0708 ndcg@10: 0.0799 ndcg@20: 0.0931 ] 
2025-04-14 09:39:50,143 - Epoch  33 Validation set [recall@5: 0.0707 recall@10: 0.1004 recall@20: 0.1391 ] [ndcg@5: 0.0713 ndcg@10: 0.0806 ndcg@20: 0.0930 ] 
2025-04-14 09:39:54,749 - Epoch  36 Validation set [recall@5: 0.0706 recall@10: 0.1005 recall@20: 0.1390 ] [ndcg@5: 0.0712 ndcg@10: 0.0806 ndcg@20: 0.0930 ] 
2025-04-14 09:39:59,207 - Epoch  39 Validation set [recall@5: 0.0700 recall@10: 0.1005 recall@20: 0.1394 ] [ndcg@5: 0.0706 ndcg@10: 0.0804 ndcg@20: 0.0930 ] 
2025-04-14 09:40:03,745 - Epoch  42 Validation set [recall@5: 0.0705 recall@10: 0.1005 recall@20: 0.1392 ] [ndcg@5: 0.0713 ndcg@10: 0.0808 ndcg@20: 0.0933 ] 
2025-04-14 09:40:08,489 - Epoch  45 Validation set [recall@5: 0.0703 recall@10: 0.1015 recall@20: 0.1388 ] [ndcg@5: 0.0713 ndcg@10: 0.0814 ndcg@20: 0.0934 ] 
2025-04-14 09:40:10,225 - [recall@5: 0.0703 recall@10: 0.0989 recall@20: 0.1398 ] [ndcg@5: 0.0708 ndcg@10: 0.0799 ndcg@20: 0.0931 ] 
2025-04-14 09:40:11,935 - [recall@5: 0.0649 recall@10: 0.0976 recall@20: 0.1374 ] [ndcg@5: 0.0666 ndcg@10: 0.0774 ndcg@20: 0.0902 ] 
2025-04-14 09:40:11,936 - Best Epoch 30. Final test result: {'recall': array([0.06487932, 0.09760708, 0.13736178]), 'ndcg': array([0.06664737, 0.07743187, 0.09024778])}.
对比学习取的是0层和第二层