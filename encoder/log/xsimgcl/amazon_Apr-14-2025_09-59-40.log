2025-04-14 09:59:40,964 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': False, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'xsimgcl', 'keep_rate': 1.0, 'embedding_size': 64, 'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.15, 'eps': 0.9, 'amazon': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.15, 'eps': 0.2}, 'yelp': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.2, 'eps': 0.9}, 'steam': {'layer_num': 3, 'layer_cl': 2, 'reg_weight': 1e-05, 'cl_weight': 0.1, 'temperature': 0.5, 'eps': 0.2}}}
2025-04-14 09:59:44,829 - Epoch   0 Validation set [recall@5: 0.0447 recall@10: 0.0678 recall@20: 0.0969 ] [ndcg@5: 0.0440 ndcg@10: 0.0519 ndcg@20: 0.0614 ] 
2025-04-14 09:59:49,350 - Epoch   3 Validation set [recall@5: 0.0565 recall@10: 0.0832 recall@20: 0.1174 ] [ndcg@5: 0.0573 ndcg@10: 0.0661 ndcg@20: 0.0770 ] 
2025-04-14 09:59:53,846 - Epoch   6 Validation set [recall@5: 0.0623 recall@10: 0.0910 recall@20: 0.1257 ] [ndcg@5: 0.0635 ndcg@10: 0.0726 ndcg@20: 0.0839 ] 
2025-04-14 09:59:58,661 - Epoch   9 Validation set [recall@5: 0.0655 recall@10: 0.0952 recall@20: 0.1299 ] [ndcg@5: 0.0668 ndcg@10: 0.0761 ndcg@20: 0.0873 ] 
2025-04-14 10:00:03,442 - Epoch  12 Validation set [recall@5: 0.0671 recall@10: 0.0964 recall@20: 0.1331 ] [ndcg@5: 0.0682 ndcg@10: 0.0774 ndcg@20: 0.0893 ] 
2025-04-14 10:00:08,236 - Epoch  15 Validation set [recall@5: 0.0691 recall@10: 0.0976 recall@20: 0.1347 ] [ndcg@5: 0.0693 ndcg@10: 0.0782 ndcg@20: 0.0903 ] 
2025-04-14 10:00:13,264 - Epoch  18 Validation set [recall@5: 0.0690 recall@10: 0.0985 recall@20: 0.1361 ] [ndcg@5: 0.0697 ndcg@10: 0.0790 ndcg@20: 0.0911 ] 
2025-04-14 10:00:18,170 - Epoch  21 Validation set [recall@5: 0.0692 recall@10: 0.0993 recall@20: 0.1372 ] [ndcg@5: 0.0697 ndcg@10: 0.0793 ndcg@20: 0.0913 ] 
2025-04-14 10:00:22,953 - Epoch  24 Validation set [recall@5: 0.0704 recall@10: 0.0984 recall@20: 0.1383 ] [ndcg@5: 0.0707 ndcg@10: 0.0795 ndcg@20: 0.0923 ] 
2025-04-14 10:00:27,612 - Epoch  27 Validation set [recall@5: 0.0702 recall@10: 0.0991 recall@20: 0.1384 ] [ndcg@5: 0.0706 ndcg@10: 0.0798 ndcg@20: 0.0924 ] 
2025-04-14 10:00:32,229 - Epoch  30 Validation set [recall@5: 0.0701 recall@10: 0.1003 recall@20: 0.1388 ] [ndcg@5: 0.0706 ndcg@10: 0.0802 ndcg@20: 0.0926 ] 
2025-04-14 10:00:36,659 - Epoch  33 Validation set [recall@5: 0.0707 recall@10: 0.1004 recall@20: 0.1392 ] [ndcg@5: 0.0709 ndcg@10: 0.0805 ndcg@20: 0.0929 ] 
2025-04-14 10:00:41,214 - Epoch  36 Validation set [recall@5: 0.0705 recall@10: 0.1011 recall@20: 0.1391 ] [ndcg@5: 0.0711 ndcg@10: 0.0807 ndcg@20: 0.0929 ] 
2025-04-14 10:00:45,619 - Epoch  39 Validation set [recall@5: 0.0699 recall@10: 0.1012 recall@20: 0.1390 ] [ndcg@5: 0.0704 ndcg@10: 0.0806 ndcg@20: 0.0928 ] 
2025-04-14 10:00:50,067 - Epoch  42 Validation set [recall@5: 0.0706 recall@10: 0.1012 recall@20: 0.1397 ] [ndcg@5: 0.0712 ndcg@10: 0.0809 ndcg@20: 0.0933 ] 
2025-04-14 10:00:54,368 - Epoch  45 Validation set [recall@5: 0.0705 recall@10: 0.1011 recall@20: 0.1400 ] [ndcg@5: 0.0711 ndcg@10: 0.0810 ndcg@20: 0.0934 ] 
2025-04-14 10:00:58,751 - Epoch  48 Validation set [recall@5: 0.0697 recall@10: 0.1008 recall@20: 0.1388 ] [ndcg@5: 0.0706 ndcg@10: 0.0807 ndcg@20: 0.0929 ] 
2025-04-14 10:01:03,006 - Epoch  51 Validation set [recall@5: 0.0699 recall@10: 0.0999 recall@20: 0.1386 ] [ndcg@5: 0.0705 ndcg@10: 0.0801 ndcg@20: 0.0925 ] 
2025-04-14 10:01:07,243 - Epoch  54 Validation set [recall@5: 0.0707 recall@10: 0.1009 recall@20: 0.1379 ] [ndcg@5: 0.0712 ndcg@10: 0.0809 ndcg@20: 0.0927 ] 
2025-04-14 10:01:11,594 - Epoch  57 Validation set [recall@5: 0.0702 recall@10: 0.1004 recall@20: 0.1382 ] [ndcg@5: 0.0711 ndcg@10: 0.0808 ndcg@20: 0.0929 ] 
2025-04-14 10:01:15,860 - Epoch  60 Validation set [recall@5: 0.0705 recall@10: 0.1001 recall@20: 0.1382 ] [ndcg@5: 0.0713 ndcg@10: 0.0806 ndcg@20: 0.0928 ] 
2025-04-14 10:01:17,447 - [recall@5: 0.0705 recall@10: 0.1011 recall@20: 0.1400 ] [ndcg@5: 0.0711 ndcg@10: 0.0810 ndcg@20: 0.0934 ] 
2025-04-14 10:01:19,057 - [recall@5: 0.0657 recall@10: 0.0982 recall@20: 0.1372 ] [ndcg@5: 0.0676 ndcg@10: 0.0781 ndcg@20: 0.0908 ] 
2025-04-14 10:01:19,057 - Best Epoch 45. Final test result: {'recall': array([0.0657101 , 0.09816288, 0.13723999]), 'ndcg': array([0.06762082, 0.07813214, 0.09080033])}.
对比学习取的是0层和第3层
