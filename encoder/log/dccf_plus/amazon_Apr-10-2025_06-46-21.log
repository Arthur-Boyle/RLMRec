2025-04-10 06:46:21,547 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': True, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'amazon', 'user_num': 11000, 'item_num': 9332}, 'model': {'name': 'dccf_plus', 'embedding_size': 32, 'intent_num': 128, 'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'cl_temperature': 0.1, 'kd_weight': 0.01, 'kd_temperature': 0.5, 'amazon': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'cl_temperature': 0.1, 'kd_weight': 0.01, 'kd_temperature': 0.5}, 'yelp': {'layer_num': 2, 'reg_weight': 0.0001, 'cl_weight': 0.001, 'cl_temperature': 0.1, 'kd_weight': 0.01, 'kd_temperature': 0.2}, 'steam': {'layer_num': 3, 'reg_weight': 0.001, 'cl_weight': 0.001, 'cl_temperature': 0.1, 'kd_weight': 0.01, 'kd_temperature': 0.5}}}
2025-04-10 06:46:26,307 - Epoch   0 Validation set [recall@5: 0.0298 recall@10: 0.0482 recall@20: 0.0789 ] [ndcg@5: 0.0301 ndcg@10: 0.0365 ndcg@20: 0.0464 ] 
2025-04-10 06:46:33,525 - Epoch   3 Validation set [recall@5: 0.0538 recall@10: 0.0844 recall@20: 0.1287 ] [ndcg@5: 0.0536 ndcg@10: 0.0639 ndcg@20: 0.0785 ] 
2025-04-10 06:46:40,717 - Epoch   6 Validation set [recall@5: 0.0593 recall@10: 0.0931 recall@20: 0.1410 ] [ndcg@5: 0.0590 ndcg@10: 0.0706 ndcg@20: 0.0863 ] 
2025-04-10 06:46:48,049 - Epoch   9 Validation set [recall@5: 0.0616 recall@10: 0.0963 recall@20: 0.1442 ] [ndcg@5: 0.0617 ndcg@10: 0.0735 ndcg@20: 0.0891 ] 
2025-04-10 06:46:55,217 - Epoch  12 Validation set [recall@5: 0.0628 recall@10: 0.0984 recall@20: 0.1469 ] [ndcg@5: 0.0628 ndcg@10: 0.0753 ndcg@20: 0.0910 ] 
2025-04-10 06:47:02,220 - Epoch  15 Validation set [recall@5: 0.0646 recall@10: 0.1008 recall@20: 0.1498 ] [ndcg@5: 0.0642 ndcg@10: 0.0768 ndcg@20: 0.0927 ] 
2025-04-10 06:47:09,433 - Epoch  18 Validation set [recall@5: 0.0660 recall@10: 0.1009 recall@20: 0.1496 ] [ndcg@5: 0.0654 ndcg@10: 0.0775 ndcg@20: 0.0932 ] 
2025-04-10 06:47:16,717 - Epoch  21 Validation set [recall@5: 0.0660 recall@10: 0.1027 recall@20: 0.1528 ] [ndcg@5: 0.0651 ndcg@10: 0.0779 ndcg@20: 0.0942 ] 
2025-04-10 06:47:23,830 - Epoch  24 Validation set [recall@5: 0.0672 recall@10: 0.1026 recall@20: 0.1518 ] [ndcg@5: 0.0665 ndcg@10: 0.0786 ndcg@20: 0.0944 ] 
2025-04-10 06:47:30,961 - Epoch  27 Validation set [recall@5: 0.0664 recall@10: 0.1023 recall@20: 0.1517 ] [ndcg@5: 0.0656 ndcg@10: 0.0782 ndcg@20: 0.0942 ] 
2025-04-10 06:47:38,119 - Epoch  30 Validation set [recall@5: 0.0657 recall@10: 0.1031 recall@20: 0.1523 ] [ndcg@5: 0.0654 ndcg@10: 0.0784 ndcg@20: 0.0944 ] 
2025-04-10 06:47:45,261 - Epoch  33 Validation set [recall@5: 0.0675 recall@10: 0.1026 recall@20: 0.1535 ] [ndcg@5: 0.0665 ndcg@10: 0.0784 ndcg@20: 0.0950 ] 
2025-04-10 06:47:52,600 - Epoch  36 Validation set [recall@5: 0.0662 recall@10: 0.1045 recall@20: 0.1548 ] [ndcg@5: 0.0660 ndcg@10: 0.0792 ndcg@20: 0.0957 ] 
2025-04-10 06:48:00,056 - Epoch  39 Validation set [recall@5: 0.0664 recall@10: 0.1031 recall@20: 0.1546 ] [ndcg@5: 0.0668 ndcg@10: 0.0795 ndcg@20: 0.0964 ] 
2025-04-10 06:48:07,205 - Epoch  42 Validation set [recall@5: 0.0666 recall@10: 0.1031 recall@20: 0.1567 ] [ndcg@5: 0.0664 ndcg@10: 0.0790 ndcg@20: 0.0964 ] 
2025-04-10 06:48:14,358 - Epoch  45 Validation set [recall@5: 0.0678 recall@10: 0.1047 recall@20: 0.1544 ] [ndcg@5: 0.0675 ndcg@10: 0.0800 ndcg@20: 0.0962 ] 
2025-04-10 06:48:21,468 - Epoch  48 Validation set [recall@5: 0.0679 recall@10: 0.1049 recall@20: 0.1555 ] [ndcg@5: 0.0669 ndcg@10: 0.0797 ndcg@20: 0.0962 ] 
2025-04-10 06:48:28,562 - Epoch  51 Validation set [recall@5: 0.0701 recall@10: 0.1055 recall@20: 0.1545 ] [ndcg@5: 0.0684 ndcg@10: 0.0805 ndcg@20: 0.0966 ] 
2025-04-10 06:48:35,909 - Epoch  54 Validation set [recall@5: 0.0688 recall@10: 0.1057 recall@20: 0.1569 ] [ndcg@5: 0.0677 ndcg@10: 0.0803 ndcg@20: 0.0969 ] 
2025-04-10 06:48:43,398 - Epoch  57 Validation set [recall@5: 0.0685 recall@10: 0.1054 recall@20: 0.1578 ] [ndcg@5: 0.0676 ndcg@10: 0.0802 ndcg@20: 0.0972 ] 
2025-04-10 06:48:50,754 - Epoch  60 Validation set [recall@5: 0.0681 recall@10: 0.1072 recall@20: 0.1564 ] [ndcg@5: 0.0678 ndcg@10: 0.0811 ndcg@20: 0.0973 ] 
2025-04-10 06:48:57,719 - Epoch  63 Validation set [recall@5: 0.0684 recall@10: 0.1072 recall@20: 0.1582 ] [ndcg@5: 0.0674 ndcg@10: 0.0811 ndcg@20: 0.0976 ] 
2025-04-10 06:49:04,729 - Epoch  66 Validation set [recall@5: 0.0675 recall@10: 0.1061 recall@20: 0.1583 ] [ndcg@5: 0.0663 ndcg@10: 0.0797 ndcg@20: 0.0966 ] 
2025-04-10 06:49:11,713 - Epoch  69 Validation set [recall@5: 0.0679 recall@10: 0.1061 recall@20: 0.1571 ] [ndcg@5: 0.0675 ndcg@10: 0.0806 ndcg@20: 0.0973 ] 
2025-04-10 06:49:18,763 - Epoch  72 Validation set [recall@5: 0.0677 recall@10: 0.1082 recall@20: 0.1589 ] [ndcg@5: 0.0668 ndcg@10: 0.0809 ndcg@20: 0.0974 ] 
2025-04-10 06:49:25,928 - Epoch  75 Validation set [recall@5: 0.0674 recall@10: 0.1068 recall@20: 0.1595 ] [ndcg@5: 0.0659 ndcg@10: 0.0797 ndcg@20: 0.0970 ] 
2025-04-10 06:49:33,024 - Epoch  78 Validation set [recall@5: 0.0673 recall@10: 0.1050 recall@20: 0.1600 ] [ndcg@5: 0.0661 ndcg@10: 0.0792 ndcg@20: 0.0972 ] 
2025-04-10 06:49:40,086 - Epoch  81 Validation set [recall@5: 0.0679 recall@10: 0.1058 recall@20: 0.1572 ] [ndcg@5: 0.0670 ndcg@10: 0.0804 ndcg@20: 0.0971 ] 
2025-04-10 06:49:47,304 - Epoch  84 Validation set [recall@5: 0.0692 recall@10: 0.1056 recall@20: 0.1573 ] [ndcg@5: 0.0680 ndcg@10: 0.0806 ndcg@20: 0.0974 ] 
2025-04-10 06:49:54,379 - Epoch  87 Validation set [recall@5: 0.0685 recall@10: 0.1059 recall@20: 0.1568 ] [ndcg@5: 0.0681 ndcg@10: 0.0808 ndcg@20: 0.0974 ] 
2025-04-10 06:50:01,374 - Epoch  90 Validation set [recall@5: 0.0685 recall@10: 0.1069 recall@20: 0.1588 ] [ndcg@5: 0.0670 ndcg@10: 0.0802 ndcg@20: 0.0970 ] 
2025-04-10 06:50:08,543 - Epoch  93 Validation set [recall@5: 0.0689 recall@10: 0.1077 recall@20: 0.1587 ] [ndcg@5: 0.0675 ndcg@10: 0.0810 ndcg@20: 0.0977 ] 
2025-04-10 06:50:10,829 - [recall@5: 0.0673 recall@10: 0.1050 recall@20: 0.1600 ] [ndcg@5: 0.0661 ndcg@10: 0.0792 ndcg@20: 0.0972 ] 
2025-04-10 06:50:13,244 - [recall@5: 0.0657 recall@10: 0.1031 recall@20: 0.1562 ] [ndcg@5: 0.0655 ndcg@10: 0.0786 ndcg@20: 0.0959 ] 
2025-04-10 06:50:13,582 - Save model parameters to ./encoder/checkpoint/dccf_plus/dccf_plus-amazon-2023.pth
2025-04-10 06:50:13,583 - Best Epoch 78. Final test result: {'recall': array([0.06572002, 0.10310546, 0.15621418]), 'ndcg': array([0.06550994, 0.07862986, 0.09585452])}.
原版