2025-05-05 10:51:24,002 - {'optimizer': {'name': 'adam', 'lr': 0.001, 'weight_decay': 0}, 'train': {'epoch': 3000, 'batch_size': 4096, 'save_model': True, 'loss': 'pairwise', 'test_step': 3, 'reproducible': True, 'seed': 2023, 'patience': 5}, 'test': {'metrics': ['recall', 'ndcg'], 'k': [5, 10, 20], 'batch_size': 1024}, 'data': {'type': 'general_cf', 'name': 'steam', 'user_num': 23310, 'item_num': 5237}, 'model': {'name': 'gccf', 'keep_rate': 0.8, 'embedding_size': 32, 'layer_num': 3, 'reg_weight': 1e-06, 'amazon': {'layer_num': 2, 'reg_weight': 1e-06}, 'yelp': {'layer_num': 2, 'reg_weight': 1e-06}, 'steam': {'layer_num': 2, 'reg_weight': 1e-06}}}
2025-05-05 10:51:30,484 - Epoch   0 Validation set [recall@5: 0.0350 recall@10: 0.0554 recall@20: 0.0902 ] [ndcg@5: 0.0413 ndcg@10: 0.0471 ndcg@20: 0.0585 ] 
2025-05-05 10:51:39,757 - Epoch   3 Validation set [recall@5: 0.0352 recall@10: 0.0550 recall@20: 0.0909 ] [ndcg@5: 0.0413 ndcg@10: 0.0468 ndcg@20: 0.0586 ] 
2025-05-05 10:51:49,499 - Epoch   6 Validation set [recall@5: 0.0350 recall@10: 0.0556 recall@20: 0.0907 ] [ndcg@5: 0.0412 ndcg@10: 0.0470 ndcg@20: 0.0585 ] 
2025-05-05 10:51:59,520 - Epoch   9 Validation set [recall@5: 0.0351 recall@10: 0.0560 recall@20: 0.0926 ] [ndcg@5: 0.0413 ndcg@10: 0.0473 ndcg@20: 0.0592 ] 
2025-05-05 10:52:09,296 - Epoch  12 Validation set [recall@5: 0.0353 recall@10: 0.0568 recall@20: 0.0941 ] [ndcg@5: 0.0415 ndcg@10: 0.0478 ndcg@20: 0.0600 ] 
2025-05-05 10:52:18,592 - Epoch  15 Validation set [recall@5: 0.0356 recall@10: 0.0590 recall@20: 0.0971 ] [ndcg@5: 0.0420 ndcg@10: 0.0492 ndcg@20: 0.0617 ] 
2025-05-05 10:52:28,014 - Epoch  18 Validation set [recall@5: 0.0362 recall@10: 0.0611 recall@20: 0.1005 ] [ndcg@5: 0.0429 ndcg@10: 0.0507 ndcg@20: 0.0637 ] 
2025-05-05 10:52:37,625 - Epoch  21 Validation set [recall@5: 0.0383 recall@10: 0.0639 recall@20: 0.1042 ] [ndcg@5: 0.0449 ndcg@10: 0.0528 ndcg@20: 0.0662 ] 
2025-05-05 10:52:46,592 - Epoch  24 Validation set [recall@5: 0.0396 recall@10: 0.0672 recall@20: 0.1075 ] [ndcg@5: 0.0462 ndcg@10: 0.0551 ndcg@20: 0.0683 ] 
2025-05-05 10:52:55,843 - Epoch  27 Validation set [recall@5: 0.0413 recall@10: 0.0687 recall@20: 0.1112 ] [ndcg@5: 0.0480 ndcg@10: 0.0566 ndcg@20: 0.0707 ] 
2025-05-05 10:53:05,537 - Epoch  30 Validation set [recall@5: 0.0427 recall@10: 0.0710 recall@20: 0.1148 ] [ndcg@5: 0.0495 ndcg@10: 0.0585 ndcg@20: 0.0730 ] 
2025-05-05 10:53:14,829 - Epoch  33 Validation set [recall@5: 0.0441 recall@10: 0.0739 recall@20: 0.1176 ] [ndcg@5: 0.0511 ndcg@10: 0.0605 ndcg@20: 0.0750 ] 
2025-05-05 10:53:24,188 - Epoch  36 Validation set [recall@5: 0.0453 recall@10: 0.0751 recall@20: 0.1196 ] [ndcg@5: 0.0519 ndcg@10: 0.0614 ndcg@20: 0.0761 ] 
2025-05-05 10:53:33,577 - Epoch  39 Validation set [recall@5: 0.0462 recall@10: 0.0760 recall@20: 0.1212 ] [ndcg@5: 0.0529 ndcg@10: 0.0624 ndcg@20: 0.0774 ] 
2025-05-05 10:53:43,376 - Epoch  42 Validation set [recall@5: 0.0468 recall@10: 0.0774 recall@20: 0.1231 ] [ndcg@5: 0.0535 ndcg@10: 0.0633 ndcg@20: 0.0784 ] 
2025-05-05 10:53:52,814 - Epoch  45 Validation set [recall@5: 0.0470 recall@10: 0.0789 recall@20: 0.1253 ] [ndcg@5: 0.0538 ndcg@10: 0.0641 ndcg@20: 0.0795 ] 
2025-05-05 10:54:02,386 - Epoch  48 Validation set [recall@5: 0.0475 recall@10: 0.0801 recall@20: 0.1271 ] [ndcg@5: 0.0543 ndcg@10: 0.0647 ndcg@20: 0.0804 ] 
2025-05-05 10:54:11,535 - Epoch  51 Validation set [recall@5: 0.0482 recall@10: 0.0797 recall@20: 0.1281 ] [ndcg@5: 0.0550 ndcg@10: 0.0650 ndcg@20: 0.0811 ] 
2025-05-05 10:54:21,522 - Epoch  54 Validation set [recall@5: 0.0485 recall@10: 0.0805 recall@20: 0.1294 ] [ndcg@5: 0.0555 ndcg@10: 0.0657 ndcg@20: 0.0820 ] 
2025-05-05 10:54:31,369 - Epoch  57 Validation set [recall@5: 0.0493 recall@10: 0.0812 recall@20: 0.1300 ] [ndcg@5: 0.0561 ndcg@10: 0.0662 ndcg@20: 0.0825 ] 
2025-05-05 10:54:40,966 - Epoch  60 Validation set [recall@5: 0.0497 recall@10: 0.0816 recall@20: 0.1311 ] [ndcg@5: 0.0564 ndcg@10: 0.0664 ndcg@20: 0.0830 ] 
2025-05-05 10:54:50,066 - Epoch  63 Validation set [recall@5: 0.0494 recall@10: 0.0820 recall@20: 0.1312 ] [ndcg@5: 0.0562 ndcg@10: 0.0666 ndcg@20: 0.0831 ] 
2025-05-05 10:54:59,209 - Epoch  66 Validation set [recall@5: 0.0497 recall@10: 0.0825 recall@20: 0.1319 ] [ndcg@5: 0.0565 ndcg@10: 0.0670 ndcg@20: 0.0836 ] 
2025-05-05 10:55:08,603 - Epoch  69 Validation set [recall@5: 0.0498 recall@10: 0.0828 recall@20: 0.1321 ] [ndcg@5: 0.0568 ndcg@10: 0.0674 ndcg@20: 0.0839 ] 
2025-05-05 10:55:18,085 - Epoch  72 Validation set [recall@5: 0.0503 recall@10: 0.0833 recall@20: 0.1323 ] [ndcg@5: 0.0570 ndcg@10: 0.0677 ndcg@20: 0.0841 ] 
2025-05-05 10:55:27,434 - Epoch  75 Validation set [recall@5: 0.0496 recall@10: 0.0830 recall@20: 0.1333 ] [ndcg@5: 0.0569 ndcg@10: 0.0676 ndcg@20: 0.0844 ] 
2025-05-05 10:55:36,938 - Epoch  78 Validation set [recall@5: 0.0503 recall@10: 0.0836 recall@20: 0.1333 ] [ndcg@5: 0.0573 ndcg@10: 0.0679 ndcg@20: 0.0846 ] 
2025-05-05 10:55:46,595 - Epoch  81 Validation set [recall@5: 0.0502 recall@10: 0.0836 recall@20: 0.1330 ] [ndcg@5: 0.0573 ndcg@10: 0.0679 ndcg@20: 0.0846 ] 
2025-05-05 10:55:56,224 - Epoch  84 Validation set [recall@5: 0.0505 recall@10: 0.0834 recall@20: 0.1329 ] [ndcg@5: 0.0573 ndcg@10: 0.0678 ndcg@20: 0.0844 ] 
2025-05-05 10:56:05,374 - Epoch  87 Validation set [recall@5: 0.0503 recall@10: 0.0836 recall@20: 0.1329 ] [ndcg@5: 0.0571 ndcg@10: 0.0677 ndcg@20: 0.0843 ] 
2025-05-05 10:56:14,605 - Epoch  90 Validation set [recall@5: 0.0506 recall@10: 0.0838 recall@20: 0.1324 ] [ndcg@5: 0.0572 ndcg@10: 0.0678 ndcg@20: 0.0842 ] 
2025-05-05 10:56:24,082 - Epoch  93 Validation set [recall@5: 0.0503 recall@10: 0.0841 recall@20: 0.1324 ] [ndcg@5: 0.0571 ndcg@10: 0.0679 ndcg@20: 0.0842 ] 
2025-05-05 10:56:27,534 - [recall@5: 0.0503 recall@10: 0.0836 recall@20: 0.1333 ] [ndcg@5: 0.0573 ndcg@10: 0.0679 ndcg@20: 0.0846 ] 
2025-05-05 10:56:30,853 - [recall@5: 0.0494 recall@10: 0.0823 recall@20: 0.1314 ] [ndcg@5: 0.0549 ndcg@10: 0.0659 ndcg@20: 0.0825 ] 
2025-05-05 10:56:30,930 - Save model parameters to ./encoder/checkpoint/gccf/gccf-steam-2023.pth
2025-05-05 10:56:30,930 - Best Epoch 78. Final test result: {'recall': array([0.04943354, 0.08234402, 0.1313548 ]), 'ndcg': array([0.05487014, 0.06591308, 0.08251863])}.
